<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MTR Duty Planner v22</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #007aff; --bg: #f2f2f7; --card: #ffffff; --text: #000000; --text-sec: #8e8e93; --border: #c6c6c8; --sep: #e5e5ea; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif; background-color: var(--bg); color: var(--text); padding-bottom: 150px; }
        .container { max-width: 600px; margin: 0 auto; min-height: 100vh; }
        .header { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 100; border-bottom: 0.5px solid var(--border); padding: 0 16px; height: 50px; display: flex; align-items: center; justify-content: space-between; }
        .header h1 { font-size: 17px; font-weight: 600; margin: 0; }
        .btn-link { border: none; background: none; color: var(--primary); font-size: 17px; font-weight: 400; cursor: pointer; padding: 10px 0; }
        .panel { background: var(--card); padding: 20px 16px; display: none; }
        .panel.active { display: block; }
        .form-group { margin-bottom: 20px; }
        .label { display: block; font-size: 13px; font-weight: 500; color: var(--text-sec); text-transform: uppercase; margin-bottom: 8px; }
        .input-text { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--sep); font-size: 17px; background: #fff; -webkit-appearance: none; color: #000; }
        .duty-row { display: flex; align-items: center; margin-bottom: 12px; }
        .day-label { width: 45px; font-size: 15px; font-weight: 600; color: var(--text-sec); }
        .duty-input { flex: 1; padding: 12px; border-radius: 10px; border: 1px solid var(--sep); font-size: 17px; font-family: monospace; font-weight: 600; -webkit-appearance: none; background: #fff; color: #000; }
        .btn-row { display: flex; gap: 12px; margin-top: 30px; }
        .btn { flex: 1; padding: 14px; border-radius: 12px; border: none; font-size: 17px; font-weight: 600; text-align: center; cursor: pointer; }
        .btn-primary { background-color: var(--primary); color: white; }
        .btn-secondary { background-color: #e5e5ea; color: var(--primary); position: relative; }
        .file-input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; }
        .list { padding: 16px; display: flex; flex-direction: column; gap: 16px; }
        .card { background: var(--card); border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .card-header { padding: 16px; display: flex; justify-content: space-between; align-items: flex-start; }
        .left-col h3 { margin: 0 0 4px 0; font-size: 19px; font-weight: 600; }
        .date-badge { display: inline-block; color: var(--text-sec); font-size: 13px; font-weight: 500; }
        .duty-id { display: block; font-size: 34px; font-weight: 700; font-family: -apple-system, monospace; letter-spacing: -1px; margin-top: 4px; color: #000; }
        .rest-text { font-size: 24px; font-weight: 600; color: #c7c7cc; margin-top: 8px; display: block; }
        .right-col { text-align: right; }
        .time-btn { font-size: 22px; font-weight: 700; color: var(--primary); background: none; border: none; padding: 0; cursor: pointer; letter-spacing: -0.5px; }
        .duration-text { font-size: 13px; font-weight: 500; color: var(--text-sec); margin-top: 4px; display: block; }
        .edit-zone { background: #f2f2f7; padding: 10px; margin-top: 10px; border-radius: 8px; display: none; gap: 8px; justify-content: flex-end; }
        .edit-zone.show { display: flex; }
        .time-edit { padding: 8px; border-radius: 8px; border: 1px solid var(--sep); background: #fff; font-size: 16px; width: 90px; text-align: center; }
        .task-list { border-top: 0.5px solid var(--sep); display: none; }
        .task-list.show { display: block; }
        .task-toggle { width: 100%; padding: 12px 16px; border: none; background: #fff; display: flex; justify-content: space-between; font-size: 13px; font-weight: 600; color: var(--text-sec); border-top: 0.5px solid var(--sep); }
        .task-item { padding: 10px 16px; background: #fafafa; border-bottom: 0.5px solid var(--sep); display: flex; gap: 10px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; background: #d1d1d6; margin-top: 5px; flex-shrink: 0; }
        .dot.blue { background: #007aff; }
        .dot.orange { background: #ff9500; }
        .dot.red { background: #ff3b30; }
        .task-content { flex: 1; }
        .task-desc { font-size: 15px; color: #000; line-height: 1.4; }
        .task-time { font-size: 12px; color: var(--text-sec); font-family: monospace; display: block; margin-top: 2px; }
        .fab-wrapper { position: fixed; bottom: 40px; left: 20px; right: 20px; z-index: 99; display: flex; gap: 10px; }
        .fab-btn { flex: 1; padding: 16px; border-radius: 16px; background: var(--primary); color: white; border: none; font-size: 16px; font-weight: 600; box-shadow: 0 4px 12px rgba(0,122,255,0.4); }
        .hidden { display: none !important; }
        #manualLink { display: none; text-align: center; margin-top: 20px; padding: 20px; background: #fff; border-radius: 12px; }
        #manualLink a { font-size: 18px; font-weight: bold; color: var(--primary); text-decoration: underline; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1 onclick="showStats()">Duty Planner</h1>
        <button class="btn-link" onclick="toggleView()">Edit</button>
    </div>

    <div id="editView" class="panel active">
        <div class="form-group">
            <label class="label">Week Starting</label>
            <input type="date" id="startDate" class="input-text" onchange="updateDate(this.value)">
        </div>
        <div id="inputContainer"></div>
        <div class="btn-row">
            <button class="btn btn-primary" onclick="saveAndShow()">Save & View</button>
            <div class="btn btn-secondary">
                Import Excel
                <input type="file" class="file-input" accept=".xlsx" onchange="handleFile(this)">
            </div>
        </div>
    </div>

    <div id="listView" class="list" style="display:none;"></div>

    <div id="manualLink">
        <p>Download ready:</p>
        <a id="downloadAnchor" href="#" target="_blank">Click here to download ICS</a>
        <button onclick="document.getElementById('manualLink').style.display='none'" style="margin-top:10px;padding:8px 16px;background:#eee;border:none;border-radius:8px;">Close</button>
    </div>

    <div id="fab" class="fab-wrapper hidden">
        <button class="fab-btn" onclick="shareCal()">Share/Save ICS</button>
        <button class="fab-btn" onclick="downloadCal()">Download</button>
    </div>
</div>

<script>
    const RAW_DB = {"35001": {"id": "35001", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "001": {"id": "001", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "01": {"id": "01", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "2025\u5e74": {"id": "2025\u5e74", "book_on": "05:30", "book_off": "11:15", "events": [{"time": "05:30", "desc": "Start"}, {"time": "05:39", "desc": "*R50 TSWD (05:39\u4e58\u5750T50 up cab\u843d\u4e2d\u74b0\u63a5T36) 06:09 CEN"}, {"time": "06:22", "desc": "36 CEN  * *CEN Start Service 07:00 TSWD \u00a8"}, {"time": "06:44", "desc": ""}, {"time": "07:04", "desc": "  53 TSWD 07:36 CEN \u00a8"}, {"time": "07:41", "desc": "38 CEN  SB  08:14 TSWD \u00a8 08:45:00"}, {"time": "09:15", "desc": "39 09:27 TSWD 09:59 CEN \u00a8"}, {"time": "10:04", "desc": "40 CEN  SB  10:39:00 TSWD \u00a8"}, {"time": "10:40", "desc": "Report to TCI for briefing/duty 11:10:00 11:15:00"}, {"time": "01:22", "desc": ""}]}, "35002": {"id": "35002", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "002": {"id": "002", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "02": {"id": "02", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "35003": {"id": "35003", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "003": {"id": "003", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "03": {"id": "03", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "35004": {"id": "35004", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "004": {"id": "004", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "04": {"id": "04", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "35005": {"id": "35005", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "005": {"id": "005", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "05": {"id": "05", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "35006": {"id": "35006", "book_on": "05:20", "book_off": "05:20", "events": [{"time": "05:20", "desc": "Start"}]}, "006": {"id": "006", "book_on": "05:20", "book_off": "05:20", "events": [{"time": "05:20", "desc": "Start"}]}, "06": {"id": "06", "book_on": "05:20", "book_off": "05:20", "events": [{"time": "05:20", "desc": "Start"}]}, "35007": {"id": "35007", "book_on": "05:24", "book_off": "05:24", "events": [{"time": "05:24", "desc": "Start"}]}, "007": {"id": "007", "book_on": "05:24", "book_off": "05:24", "events": [{"time": "05:24", "desc": "Start"}]}, "07": {"id": "07", "book_on": "05:24", "book_off": "05:24", "events": [{"time": "05:24", "desc": "Start"}]}, "35008": {"id": "35008", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "008": {"id": "008", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "08": {"id": "08", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "35009": {"id": "35009", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "009": {"id": "009", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "09": {"id": "09", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "35010": {"id": "35010", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "010": {"id": "010", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "10": {"id": "10", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "35011": {"id": "35011", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "011": {"id": "011", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "11": {"id": "11", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "35012": {"id": "35012", "book_on": "05:36", "book_off": "05:36", "events": [{"time": "05:36", "desc": "Start"}]}, "012": {"id": "012", "book_on": "05:36", "book_off": "05:36", "events": [{"time": "05:36", "desc": "Start"}]}, "12": {"id": "12", "book_on": "05:36", "book_off": "05:36", "events": [{"time": "05:36", "desc": "Start"}]}, "35013": {"id": "35013", "book_on": "05:38", "book_off": "05:38", "events": [{"time": "05:38", "desc": "Start"}]}, "013": {"id": "013", "book_on": "05:38", "book_off": "05:38", "events": [{"time": "05:38", "desc": "Start"}]}, "13": {"id": "13", "book_on": "05:38", "book_off": "05:38", "events": [{"time": "05:38", "desc": "Start"}]}, "35014": {"id": "35014", "book_on": "05:48", "book_off": "05:48", "events": [{"time": "05:48", "desc": "Start"}]}, "014": {"id": "014", "book_on": "05:48", "book_off": "05:48", "events": [{"time": "05:48", "desc": "Start"}]}, "14": {"id": "14", "book_on": "05:48", "book_off": "05:48", "events": [{"time": "05:48", "desc": "Start"}]}, "35015": {"id": "35015", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "015": {"id": "015", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "15": {"id": "15", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "35016": {"id": "35016", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "016": {"id": "016", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "16": {"id": "16", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "35017": {"id": "35017", "book_on": "05:57", "book_off": "05:57", "events": [{"time": "05:57", "desc": "Start"}]}, "017": {"id": "017", "book_on": "05:57", "book_off": "05:57", "events": [{"time": "05:57", "desc": "Start"}]}, "17": {"id": "17", "book_on": "05:57", "book_off": "05:57", "events": [{"time": "05:57", "desc": "Start"}]}, "35018": {"id": "35018", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "018": {"id": "018", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "18": {"id": "18", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "35019": {"id": "35019", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "019": {"id": "019", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "19": {"id": "19", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "35020": {"id": "35020", "book_on": "06:14", "book_off": "06:14", "events": [{"time": "06:14", "desc": "Start"}]}, "020": {"id": "020", "book_on": "06:14", "book_off": "06:14", "events": [{"time": "06:14", "desc": "Start"}]}, "20": {"id": "20", "book_on": "06:14", "book_off": "06:14", "events": [{"time": "06:14", "desc": "Start"}]}, "35021": {"id": "35021", "book_on": "06:18", "book_off": "06:18", "events": [{"time": "06:18", "desc": "Start"}]}, "021": {"id": "021", "book_on": "06:18", "book_off": "06:18", "events": [{"time": "06:18", "desc": "Start"}]}, "21": {"id": "21", "book_on": "06:18", "book_off": "06:18", "events": [{"time": "06:18", "desc": "Start"}]}, "35022": {"id": "35022", "book_on": "06:27", "book_off": "06:27", "events": [{"time": "06:27", "desc": "Start"}]}, "022": {"id": "022", "book_on": "06:27", "book_off": "06:27", "events": [{"time": "06:27", "desc": "Start"}]}, "22": {"id": "22", "book_on": "06:27", "book_off": "06:27", "events": [{"time": "06:27", "desc": "Start"}]}, "35023": {"id": "35023", "book_on": "06:31", "book_off": "06:31", "events": [{"time": "06:31", "desc": "Start"}]}, "023": {"id": "023", "book_on": "06:31", "book_off": "06:31", "events": [{"time": "06:31", "desc": "Start"}]}, "23": {"id": "23", "book_on": "06:31", "book_off": "06:31", "events": [{"time": "06:31", "desc": "Start"}]}, "35024": {"id": "35024", "book_on": "06:35", "book_off": "06:35", "events": [{"time": "06:35", "desc": "Start"}]}, "024": {"id": "024", "book_on": "06:35", "book_off": "06:35", "events": [{"time": "06:35", "desc": "Start"}]}, "24": {"id": "24", "book_on": "06:35", "book_off": "06:35", "events": [{"time": "06:35", "desc": "Start"}]}, "35025": {"id": "35025", "book_on": "06:38", "book_off": "06:38", "events": [{"time": "06:38", "desc": "Start"}]}, "025": {"id": "025", "book_on": "06:38", "book_off": "06:38", "events": [{"time": "06:38", "desc": "Start"}]}, "25": {"id": "25", "book_on": "06:38", "book_off": "06:38", "events": [{"time": "06:38", "desc": "Start"}]}, "35026": {"id": "35026", "book_on": "06:42", "book_off": "06:42", "events": [{"time": "06:42", "desc": "Start"}]}, "026": {"id": "026", "book_on": "06:42", "book_off": "06:42", "events": [{"time": "06:42", "desc": "Start"}]}, "26": {"id": "26", "book_on": "06:42", "book_off": "06:42", "events": [{"time": "06:42", "desc": "Start"}]}, "35027": {"id": "35027", "book_on": "06:45", "book_off": "06:45", "events": [{"time": "06:45", "desc": "Start"}]}, "027": {"id": "027", "book_on": "06:45", "book_off": "06:45", "events": [{"time": "06:45", "desc": "Start"}]}, "27": {"id": "27", "book_on": "06:45", "book_off": "06:45", "events": [{"time": "06:45", "desc": "Start"}]}, "35028": {"id": "35028", "book_on": "06:46", "book_off": "06:46", "events": [{"time": "06:46", "desc": "Start"}]}, "028": {"id": "028", "book_on": "06:46", "book_off": "06:46", "events": [{"time": "06:46", "desc": "Start"}]}, "28": {"id": "28", "book_on": "06:46", "book_off": "06:46", "events": [{"time": "06:46", "desc": "Start"}]}, "35029": {"id": "35029", "book_on": "06:50", "book_off": "06:50", "events": [{"time": "06:50", "desc": "Start"}]}, "029": {"id": "029", "book_on": "06:50", "book_off": "06:50", "events": [{"time": "06:50", "desc": "Start"}]}, "29": {"id": "29", "book_on": "06:50", "book_off": "06:50", "events": [{"time": "06:50", "desc": "Start"}]}, "35030": {"id": "35030", "book_on": "06:55", "book_off": "06:55", "events": [{"time": "06:55", "desc": "Start"}]}, "030": {"id": "030", "book_on": "06:55", "book_off": "06:55", "events": [{"time": "06:55", "desc": "Start"}]}, "30": {"id": "30", "book_on": "06:55", "book_off": "06:55", "events": [{"time": "06:55", "desc": "Start"}]}, "35031": {"id": "35031", "book_on": "06:59", "book_off": "06:59", "events": [{"time": "06:59", "desc": "Start"}]}, "031": {"id": "031", "book_on": "06:59", "book_off": "06:59", "events": [{"time": "06:59", "desc": "Start"}]}, "31": {"id": "31", "book_on": "06:59", "book_off": "06:59", "events": [{"time": "06:59", "desc": "Start"}]}, "35032": {"id": "35032", "book_on": "07:03", "book_off": "07:03", "events": [{"time": "07:03", "desc": "Start"}]}, "032": {"id": "032", "book_on": "07:03", "book_off": "07:03", "events": [{"time": "07:03", "desc": "Start"}]}, "32": {"id": "32", "book_on": "07:03", "book_off": "07:03", "events": [{"time": "07:03", "desc": "Start"}]}, "35033": {"id": "35033", "book_on": "07:10", "book_off": "07:10", "events": [{"time": "07:10", "desc": "Start"}]}, "033": {"id": "033", "book_on": "07:10", "book_off": "07:10", "events": [{"time": "07:10", "desc": "Start"}]}, "33": {"id": "33", "book_on": "07:10", "book_off": "07:10", "events": [{"time": "07:10", "desc": "Start"}]}, "F1": {"id": "F1", "book_on": "07:17", "book_off": "07:17", "events": [{"time": "07:17", "desc": "Start"}]}, "35034": {"id": "35034", "book_on": "07:18", "book_off": "07:18", "events": [{"time": "07:18", "desc": "Start"}]}, "034": {"id": "034", "book_on": "07:18", "book_off": "07:18", "events": [{"time": "07:18", "desc": "Start"}]}, "34": {"id": "34", "book_on": "07:18", "book_off": "07:18", "events": [{"time": "07:18", "desc": "Start"}]}, "35035": {"id": "35035", "book_on": "07:45", "book_off": "07:45", "events": [{"time": "07:45", "desc": "Start"}]}, "035": {"id": "035", "book_on": "07:45", "book_off": "07:45", "events": [{"time": "07:45", "desc": "Start"}]}, "35": {"id": "35", "book_on": "07:45", "book_off": "07:45", "events": [{"time": "07:45", "desc": "Start"}]}, "35036": {"id": "35036", "book_on": "08:04", "book_off": "08:04", "events": [{"time": "08:04", "desc": "Start"}]}, "036": {"id": "036", "book_on": "08:04", "book_off": "08:04", "events": [{"time": "08:04", "desc": "Start"}]}, "36": {"id": "36", "book_on": "08:04", "book_off": "08:04", "events": [{"time": "08:04", "desc": "Start"}]}, "35037": {"id": "35037", "book_on": "08:08", "book_off": "08:08", "events": [{"time": "08:08", "desc": "Start"}]}, "037": {"id": "037", "book_on": "08:08", "book_off": "08:08", "events": [{"time": "08:08", "desc": "Start"}]}, "37": {"id": "37", "book_on": "08:08", "book_off": "08:08", "events": [{"time": "08:08", "desc": "Start"}]}, "35038": {"id": "35038", "book_on": "08:13", "book_off": "08:13", "events": [{"time": "08:13", "desc": "Start"}]}, "038": {"id": "038", "book_on": "08:13", "book_off": "08:13", "events": [{"time": "08:13", "desc": "Start"}]}, "38": {"id": "38", "book_on": "08:13", "book_off": "08:13", "events": [{"time": "08:13", "desc": "Start"}]}, "35039": {"id": "35039", "book_on": "08:17", "book_off": "08:17", "events": [{"time": "08:17", "desc": "Start"}]}, "039": {"id": "039", "book_on": "08:17", "book_off": "08:17", "events": [{"time": "08:17", "desc": "Start"}]}, "39": {"id": "39", "book_on": "08:17", "book_off": "08:17", "events": [{"time": "08:17", "desc": "Start"}]}, "35040": {"id": "35040", "book_on": "08:28", "book_off": "08:28", "events": [{"time": "08:28", "desc": "Start"}]}, "040": {"id": "040", "book_on": "08:28", "book_off": "08:28", "events": [{"time": "08:28", "desc": "Start"}]}, "40": {"id": "40", "book_on": "08:28", "book_off": "08:28", "events": [{"time": "08:28", "desc": "Start"}]}, "35041": {"id": "35041", "book_on": "08:32", "book_off": "08:32", "events": [{"time": "08:32", "desc": "Start"}]}, "041": {"id": "041", "book_on": "08:32", "book_off": "08:32", "events": [{"time": "08:32", "desc": "Start"}]}, "41": {"id": "41", "book_on": "08:32", "book_off": "08:32", "events": [{"time": "08:32", "desc": "Start"}]}, "35042": {"id": "35042", "book_on": "08:45", "book_off": "08:45", "events": [{"time": "08:45", "desc": "Start"}]}, "042": {"id": "042", "book_on": "08:45", "book_off": "08:45", "events": [{"time": "08:45", "desc": "Start"}]}, "42": {"id": "42", "book_on": "08:45", "book_off": "08:45", "events": [{"time": "08:45", "desc": "Start"}]}, "35043": {"id": "35043", "book_on": "09:02", "book_off": "09:02", "events": [{"time": "09:02", "desc": "Start"}]}, "043": {"id": "043", "book_on": "09:02", "book_off": "09:02", "events": [{"time": "09:02", "desc": "Start"}]}, "43": {"id": "43", "book_on": "09:02", "book_off": "09:02", "events": [{"time": "09:02", "desc": "Start"}]}, "35044": {"id": "35044", "book_on": "09:15", "book_off": "09:15", "events": [{"time": "09:15", "desc": "Start"}]}, "044": {"id": "044", "book_on": "09:15", "book_off": "09:15", "events": [{"time": "09:15", "desc": "Start"}]}, "44": {"id": "44", "book_on": "09:15", "book_off": "09:15", "events": [{"time": "09:15", "desc": "Start"}]}, "35045": {"id": "35045", "book_on": "12:30", "book_off": "12:30", "events": [{"time": "12:30", "desc": "Start"}]}, "045": {"id": "045", "book_on": "12:30", "book_off": "12:30", "events": [{"time": "12:30", "desc": "Start"}]}, "45": {"id": "45", "book_on": "12:30", "book_off": "12:30", "events": [{"time": "12:30", "desc": "Start"}]}, "35046": {"id": "35046", "book_on": "12:41", "book_off": "12:41", "events": [{"time": "12:41", "desc": "Start"}]}, "046": {"id": "046", "book_on": "12:41", "book_off": "12:41", "events": [{"time": "12:41", "desc": "Start"}]}, "46": {"id": "46", "book_on": "12:41", "book_off": "12:41", "events": [{"time": "12:41", "desc": "Start"}]}, "35047": {"id": "35047", "book_on": "13:20", "book_off": "13:20", "events": [{"time": "13:20", "desc": "Start"}]}, "047": {"id": "047", "book_on": "13:20", "book_off": "13:20", "events": [{"time": "13:20", "desc": "Start"}]}, "47": {"id": "47", "book_on": "13:20", "book_off": "13:20", "events": [{"time": "13:20", "desc": "Start"}]}, "35048": {"id": "35048", "book_on": "13:27", "book_off": "13:27", "events": [{"time": "13:27", "desc": "Start"}]}, "048": {"id": "048", "book_on": "13:27", "book_off": "13:27", "events": [{"time": "13:27", "desc": "Start"}]}, "48": {"id": "48", "book_on": "13:27", "book_off": "13:27", "events": [{"time": "13:27", "desc": "Start"}]}, "35049": {"id": "35049", "book_on": "13:34", "book_off": "13:34", "events": [{"time": "13:34", "desc": "Start"}]}, "049": {"id": "049", "book_on": "13:34", "book_off": "13:34", "events": [{"time": "13:34", "desc": "Start"}]}, "49": {"id": "49", "book_on": "13:34", "book_off": "13:34", "events": [{"time": "13:34", "desc": "Start"}]}, "35050": {"id": "35050", "book_on": "14:23", "book_off": "14:23", "events": [{"time": "14:23", "desc": "Start"}]}, "050": {"id": "050", "book_on": "14:23", "book_off": "14:23", "events": [{"time": "14:23", "desc": "Start"}]}, "50": {"id": "50", "book_on": "14:23", "book_off": "14:23", "events": [{"time": "14:23", "desc": "Start"}]}, "35051": {"id": "35051", "book_on": "14:48", "book_off": "14:48", "events": [{"time": "14:48", "desc": "Start"}]}, "051": {"id": "051", "book_on": "14:48", "book_off": "14:48", "events": [{"time": "14:48", "desc": "Start"}]}, "51": {"id": "51", "book_on": "14:48", "book_off": "14:48", "events": [{"time": "14:48", "desc": "Start"}]}, "35052": {"id": "35052", "book_on": "14:55", "book_off": "14:55", "events": [{"time": "14:55", "desc": "Start"}]}, "052": {"id": "052", "book_on": "14:55", "book_off": "14:55", "events": [{"time": "14:55", "desc": "Start"}]}, "52": {"id": "52", "book_on": "14:55", "book_off": "14:55", "events": [{"time": "14:55", "desc": "Start"}]}, "35053": {"id": "35053", "book_on": "15:03", "book_off": "15:03", "events": [{"time": "15:03", "desc": "Start"}]}, "053": {"id": "053", "book_on": "15:03", "book_off": "15:03", "events": [{"time": "15:03", "desc": "Start"}]}, "53": {"id": "53", "book_on": "15:03", "book_off": "15:03", "events": [{"time": "15:03", "desc": "Start"}]}, "35054": {"id": "35054", "book_on": "15:10", "book_off": "15:10", "events": [{"time": "15:10", "desc": "Start"}]}, "054": {"id": "054", "book_on": "15:10", "book_off": "15:10", "events": [{"time": "15:10", "desc": "Start"}]}, "54": {"id": "54", "book_on": "15:10", "book_off": "15:10", "events": [{"time": "15:10", "desc": "Start"}]}, "35055": {"id": "35055", "book_on": "15:13", "book_off": "15:13", "events": [{"time": "15:13", "desc": "Start"}]}, "055": {"id": "055", "book_on": "15:13", "book_off": "15:13", "events": [{"time": "15:13", "desc": "Start"}]}, "55": {"id": "55", "book_on": "15:13", "book_off": "15:13", "events": [{"time": "15:13", "desc": "Start"}]}, "35056": {"id": "35056", "book_on": "15:24", "book_off": "15:24", "events": [{"time": "15:24", "desc": "Start"}]}, "056": {"id": "056", "book_on": "15:24", "book_off": "15:24", "events": [{"time": "15:24", "desc": "Start"}]}, "56": {"id": "56", "book_on": "15:24", "book_off": "15:24", "events": [{"time": "15:24", "desc": "Start"}]}, "35057": {"id": "35057", "book_on": "15:27", "book_off": "15:27", "events": [{"time": "15:27", "desc": "Start"}]}, "057": {"id": "057", "book_on": "15:27", "book_off": "15:27", "events": [{"time": "15:27", "desc": "Start"}]}, "57": {"id": "57", "book_on": "15:27", "book_off": "15:27", "events": [{"time": "15:27", "desc": "Start"}]}, "35058": {"id": "35058", "book_on": "15:28", "book_off": "15:28", "events": [{"time": "15:28", "desc": "Start"}]}, "058": {"id": "058", "book_on": "15:28", "book_off": "15:28", "events": [{"time": "15:28", "desc": "Start"}]}, "58": {"id": "58", "book_on": "15:28", "book_off": "15:28", "events": [{"time": "15:28", "desc": "Start"}]}, "35059": {"id": "35059", "book_on": "15:31", "book_off": "15:31", "events": [{"time": "15:31", "desc": "Start"}]}, "059": {"id": "059", "book_on": "15:31", "book_off": "15:31", "events": [{"time": "15:31", "desc": "Start"}]}, "59": {"id": "59", "book_on": "15:31", "book_off": "15:31", "events": [{"time": "15:31", "desc": "Start"}]}, "35060": {"id": "35060", "book_on": "15:35", "book_off": "15:35", "events": [{"time": "15:35", "desc": "Start"}]}, "060": {"id": "060", "book_on": "15:35", "book_off": "15:35", "events": [{"time": "15:35", "desc": "Start"}]}, "60": {"id": "60", "book_on": "15:35", "book_off": "15:35", "events": [{"time": "15:35", "desc": "Start"}]}, "35061": {"id": "35061", "book_on": "15:39", "book_off": "15:39", "events": [{"time": "15:39", "desc": "Start"}]}, "061": {"id": "061", "book_on": "15:39", "book_off": "15:39", "events": [{"time": "15:39", "desc": "Start"}]}, "61": {"id": "61", "book_on": "15:39", "book_off": "15:39", "events": [{"time": "15:39", "desc": "Start"}]}, "35062": {"id": "35062", "book_on": "15:42", "book_off": "15:42", "events": [{"time": "15:42", "desc": "Start"}]}, "062": {"id": "062", "book_on": "15:42", "book_off": "15:42", "events": [{"time": "15:42", "desc": "Start"}]}, "62": {"id": "62", "book_on": "15:42", "book_off": "15:42", "events": [{"time": "15:42", "desc": "Start"}]}, "35063": {"id": "35063", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "063": {"id": "063", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "63": {"id": "63", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "35064": {"id": "35064", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "064": {"id": "064", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "64": {"id": "64", "book_on": "15:45", "book_off": "15:45", "events": [{"time": "15:45", "desc": "Start"}]}, "35065": {"id": "35065", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "065": {"id": "065", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "65": {"id": "65", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "35066": {"id": "35066", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "066": {"id": "066", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "66": {"id": "66", "book_on": "15:49", "book_off": "15:49", "events": [{"time": "15:49", "desc": "Start"}]}, "35067": {"id": "35067", "book_on": "15:51", "book_off": "15:51", "events": [{"time": "15:51", "desc": "Start"}]}, "067": {"id": "067", "book_on": "15:51", "book_off": "15:51", "events": [{"time": "15:51", "desc": "Start"}]}, "67": {"id": "67", "book_on": "15:51", "book_off": "15:51", "events": [{"time": "15:51", "desc": "Start"}]}, "35068": {"id": "35068", "book_on": "15:55", "book_off": "15:55", "events": [{"time": "15:55", "desc": "Start"}]}, "068": {"id": "068", "book_on": "15:55", "book_off": "15:55", "events": [{"time": "15:55", "desc": "Start"}]}, "68": {"id": "68", "book_on": "15:55", "book_off": "15:55", "events": [{"time": "15:55", "desc": "Start"}]}, "35069": {"id": "35069", "book_on": "16:14", "book_off": "16:14", "events": [{"time": "16:14", "desc": "Start"}]}, "069": {"id": "069", "book_on": "16:14", "book_off": "16:14", "events": [{"time": "16:14", "desc": "Start"}]}, "69": {"id": "69", "book_on": "16:14", "book_off": "16:14", "events": [{"time": "16:14", "desc": "Start"}]}, "35070": {"id": "35070", "book_on": "16:16", "book_off": "16:16", "events": [{"time": "16:16", "desc": "Start"}]}, "070": {"id": "070", "book_on": "16:16", "book_off": "16:16", "events": [{"time": "16:16", "desc": "Start"}]}, "70": {"id": "70", "book_on": "16:16", "book_off": "16:16", "events": [{"time": "16:16", "desc": "Start"}]}, "35071": {"id": "35071", "book_on": "16:29", "book_off": "16:29", "events": [{"time": "16:29", "desc": "Start"}]}, "071": {"id": "071", "book_on": "16:29", "book_off": "16:29", "events": [{"time": "16:29", "desc": "Start"}]}, "71": {"id": "71", "book_on": "16:29", "book_off": "16:29", "events": [{"time": "16:29", "desc": "Start"}]}, "35072": {"id": "35072", "book_on": "16:33", "book_off": "16:33", "events": [{"time": "16:33", "desc": "Start"}]}, "072": {"id": "072", "book_on": "16:33", "book_off": "16:33", "events": [{"time": "16:33", "desc": "Start"}]}, "72": {"id": "72", "book_on": "16:33", "book_off": "16:33", "events": [{"time": "16:33", "desc": "Start"}]}, "35073": {"id": "35073", "book_on": "16:36", "book_off": "16:36", "events": [{"time": "16:36", "desc": "Start"}]}, "073": {"id": "073", "book_on": "16:36", "book_off": "16:36", "events": [{"time": "16:36", "desc": "Start"}]}, "73": {"id": "73", "book_on": "16:36", "book_off": "16:36", "events": [{"time": "16:36", "desc": "Start"}]}, "35074": {"id": "35074", "book_on": "16:38", "book_off": "16:38", "events": [{"time": "16:38", "desc": "Start"}]}, "074": {"id": "074", "book_on": "16:38", "book_off": "16:38", "events": [{"time": "16:38", "desc": "Start"}]}, "74": {"id": "74", "book_on": "16:38", "book_off": "16:38", "events": [{"time": "16:38", "desc": "Start"}]}, "35075": {"id": "35075", "book_on": "16:40", "book_off": "16:40", "events": [{"time": "16:40", "desc": "Start"}]}, "075": {"id": "075", "book_on": "16:40", "book_off": "16:40", "events": [{"time": "16:40", "desc": "Start"}]}, "75": {"id": "75", "book_on": "16:40", "book_off": "16:40", "events": [{"time": "16:40", "desc": "Start"}]}, "35076": {"id": "35076", "book_on": "16:48", "book_off": "16:48", "events": [{"time": "16:48", "desc": "Start"}]}, "076": {"id": "076", "book_on": "16:48", "book_off": "16:48", "events": [{"time": "16:48", "desc": "Start"}]}, "76": {"id": "76", "book_on": "16:48", "book_off": "16:48", "events": [{"time": "16:48", "desc": "Start"}]}, "35077": {"id": "35077", "book_on": "16:51", "book_off": "16:51", "events": [{"time": "16:51", "desc": "Start"}]}, "077": {"id": "077", "book_on": "16:51", "book_off": "16:51", "events": [{"time": "16:51", "desc": "Start"}]}, "77": {"id": "77", "book_on": "16:51", "book_off": "16:51", "events": [{"time": "16:51", "desc": "Start"}]}, "35078": {"id": "35078", "book_on": "16:53", "book_off": "16:53", "events": [{"time": "16:53", "desc": "Start"}]}, "078": {"id": "078", "book_on": "16:53", "book_off": "16:53", "events": [{"time": "16:53", "desc": "Start"}]}, "78": {"id": "78", "book_on": "16:53", "book_off": "16:53", "events": [{"time": "16:53", "desc": "Start"}]}, "35079": {"id": "35079", "book_on": "16:55", "book_off": "16:55", "events": [{"time": "16:55", "desc": "Start"}]}, "079": {"id": "079", "book_on": "16:55", "book_off": "16:55", "events": [{"time": "16:55", "desc": "Start"}]}, "79": {"id": "79", "book_on": "16:55", "book_off": "16:55", "events": [{"time": "16:55", "desc": "Start"}]}, "35080": {"id": "35080", "book_on": "17:03", "book_off": "17:03", "events": [{"time": "17:03", "desc": "Start"}]}, "080": {"id": "080", "book_on": "17:03", "book_off": "17:03", "events": [{"time": "17:03", "desc": "Start"}]}, "80": {"id": "80", "book_on": "17:03", "book_off": "17:03", "events": [{"time": "17:03", "desc": "Start"}]}, "35081": {"id": "35081", "book_on": "17:05", "book_off": "17:05", "events": [{"time": "17:05", "desc": "Start"}]}, "081": {"id": "081", "book_on": "17:05", "book_off": "17:05", "events": [{"time": "17:05", "desc": "Start"}]}, "81": {"id": "81", "book_on": "17:05", "book_off": "17:05", "events": [{"time": "17:05", "desc": "Start"}]}, "35082": {"id": "35082", "book_on": "17:08", "book_off": "17:08", "events": [{"time": "17:08", "desc": "Start"}]}, "082": {"id": "082", "book_on": "17:08", "book_off": "17:08", "events": [{"time": "17:08", "desc": "Start"}]}, "82": {"id": "82", "book_on": "17:08", "book_off": "17:08", "events": [{"time": "17:08", "desc": "Start"}]}, "35083": {"id": "35083", "book_on": "17:10", "book_off": "17:10", "events": [{"time": "17:10", "desc": "Start"}]}, "083": {"id": "083", "book_on": "17:10", "book_off": "17:10", "events": [{"time": "17:10", "desc": "Start"}]}, "83": {"id": "83", "book_on": "17:10", "book_off": "17:10", "events": [{"time": "17:10", "desc": "Start"}]}, "35084": {"id": "35084", "book_on": "17:12", "book_off": "17:12", "events": [{"time": "17:12", "desc": "Start"}]}, "084": {"id": "084", "book_on": "17:12", "book_off": "17:12", "events": [{"time": "17:12", "desc": "Start"}]}, "84": {"id": "84", "book_on": "17:12", "book_off": "17:12", "events": [{"time": "17:12", "desc": "Start"}]}, "35085": {"id": "35085", "book_on": "17:14", "book_off": "17:14", "events": [{"time": "17:14", "desc": "Start"}]}, "085": {"id": "085", "book_on": "17:14", "book_off": "17:14", "events": [{"time": "17:14", "desc": "Start"}]}, "85": {"id": "85", "book_on": "17:14", "book_off": "17:14", "events": [{"time": "17:14", "desc": "Start"}]}, "35086": {"id": "35086", "book_on": "17:20", "book_off": "17:20", "events": [{"time": "17:20", "desc": "Start"}]}, "086": {"id": "086", "book_on": "17:20", "book_off": "17:20", "events": [{"time": "17:20", "desc": "Start"}]}, "86": {"id": "86", "book_on": "17:20", "book_off": "17:20", "events": [{"time": "17:20", "desc": "Start"}]}, "35087": {"id": "35087", "book_on": "17:25", "book_off": "17:25", "events": [{"time": "17:25", "desc": "Start"}]}, "087": {"id": "087", "book_on": "17:25", "book_off": "17:25", "events": [{"time": "17:25", "desc": "Start"}]}, "87": {"id": "87", "book_on": "17:25", "book_off": "17:25", "events": [{"time": "17:25", "desc": "Start"}]}, "35088": {"id": "35088", "book_on": "17:29", "book_off": "17:29", "events": [{"time": "17:29", "desc": "Start"}]}, "088": {"id": "088", "book_on": "17:29", "book_off": "17:29", "events": [{"time": "17:29", "desc": "Start"}]}, "88": {"id": "88", "book_on": "17:29", "book_off": "17:29", "events": [{"time": "17:29", "desc": "Start"}]}, "35089": {"id": "35089", "book_on": "17:35", "book_off": "17:35", "events": [{"time": "17:35", "desc": "Start"}]}, "089": {"id": "089", "book_on": "17:35", "book_off": "17:35", "events": [{"time": "17:35", "desc": "Start"}]}, "89": {"id": "89", "book_on": "17:35", "book_off": "17:35", "events": [{"time": "17:35", "desc": "Start"}]}, "35090": {"id": "35090", "book_on": "17:40", "book_off": "17:40", "events": [{"time": "17:40", "desc": "Start"}]}, "090": {"id": "090", "book_on": "17:40", "book_off": "17:40", "events": [{"time": "17:40", "desc": "Start"}]}, "90": {"id": "90", "book_on": "17:40", "book_off": "17:40", "events": [{"time": "17:40", "desc": "Start"}]}, "35091": {"id": "35091", "book_on": "17:44", "book_off": "17:44", "events": [{"time": "17:44", "desc": "Start"}]}, "091": {"id": "091", "book_on": "17:44", "book_off": "17:44", "events": [{"time": "17:44", "desc": "Start"}]}, "91": {"id": "91", "book_on": "17:44", "book_off": "17:44", "events": [{"time": "17:44", "desc": "Start"}]}, "1": {"id": "1", "book_on": "00:20", "book_off": "01:22", "events": [{"time": "00:20", "desc": "SA 42 CEN MOK Up 00:30:16"}, {"time": "00:21", "desc": "ADM Up PRE Up 00:31:46"}, {"time": "00:24", "desc": "TST Up MEF Up 00:38:59"}, {"time": "00:20", "desc": "A \u4e0b\u4e00\u7ad9\u91d1\u9418,  Next station Admiralty"}, {"time": "00:21", "desc": "B \u4e0b\u4e00\u7ad9\u5c16\u6c99\u5480,  Next station Tsim Sha Tsui"}, {"time": "00:36", "desc": "C \u4e0b\u4e00\u7ad9\u7f8e\u5b5a,      Next station Mei Foo"}, {"time": "01:22", "desc": ""}]}, "35092": {"id": "35092", "book_on": "17:50", "book_off": "17:50", "events": [{"time": "17:50", "desc": "Start"}]}, "092": {"id": "092", "book_on": "17:50", "book_off": "17:50", "events": [{"time": "17:50", "desc": "Start"}]}, "92": {"id": "92", "book_on": "17:50", "book_off": "17:50", "events": [{"time": "17:50", "desc": "Start"}]}, "35093": {"id": "35093", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "093": {"id": "093", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "93": {"id": "93", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "35094": {"id": "35094", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "094": {"id": "094", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "94": {"id": "94", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "35095": {"id": "35095", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "095": {"id": "095", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "95": {"id": "95", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "35096": {"id": "35096", "book_on": "13:30", "book_off": "13:30", "events": [{"time": "13:30", "desc": "Start"}]}, "096": {"id": "096", "book_on": "13:30", "book_off": "13:30", "events": [{"time": "13:30", "desc": "Start"}]}, "96": {"id": "96", "book_on": "13:30", "book_off": "13:30", "events": [{"time": "13:30", "desc": "Start"}]}, "35097": {"id": "35097", "book_on": "17:50", "book_off": "06:02", "events": [{"time": "17:50", "desc": "Start"}, {"time": "05:20", "desc": "CEN 01 *32 06:06 CEN * 1st Passenger Train (TWL/up-line) 06:44 TSWD \u00a8"}, {"time": "06:06", "desc": "** TWL Up Line\u982d\u73ed\u5ba2\u8eca, TSW U\u4e0d\u884cAT, Auto\u51fa\u5165T/R **"}, {"time": "01:22", "desc": "\u982d\u8eca"}, {"time": "05:53", "desc": "CEN 02 36 ADS PREPARATION 05:57 ADM \u00a8"}, {"time": "06:22", "desc": "36 06:01 ADM 06:02 CEN \u00a8"}, {"time": "06:22", "desc": "CEN U 36 CEN  *Standby at up-end cab, wait for TWL crew,*CEN start service"}]}, "097": {"id": "097", "book_on": "17:50", "book_off": "06:02", "events": [{"time": "17:50", "desc": "Start"}, {"time": "05:20", "desc": "CEN 01 *32 06:06 CEN * 1st Passenger Train (TWL/up-line) 06:44 TSWD \u00a8"}, {"time": "06:06", "desc": "** TWL Up Line\u982d\u73ed\u5ba2\u8eca, TSW U\u4e0d\u884cAT, Auto\u51fa\u5165T/R **"}, {"time": "01:22", "desc": "\u982d\u8eca"}, {"time": "05:53", "desc": "CEN 02 36 ADS PREPARATION 05:57 ADM \u00a8"}, {"time": "06:22", "desc": "36 06:01 ADM 06:02 CEN \u00a8"}, {"time": "06:22", "desc": "CEN U 36 CEN  *Standby at up-end cab, wait for TWL crew,*CEN start service"}]}, "97": {"id": "97", "book_on": "17:50", "book_off": "06:02", "events": [{"time": "17:50", "desc": "Start"}, {"time": "05:20", "desc": "CEN 01 *32 06:06 CEN * 1st Passenger Train (TWL/up-line) 06:44 TSWD \u00a8"}, {"time": "06:06", "desc": "** TWL Up Line\u982d\u73ed\u5ba2\u8eca, TSW U\u4e0d\u884cAT, Auto\u51fa\u5165T/R **"}, {"time": "01:22", "desc": "\u982d\u8eca"}, {"time": "05:53", "desc": "CEN 02 36 ADS PREPARATION 05:57 ADM \u00a8"}, {"time": "06:22", "desc": "36 06:01 ADM 06:02 CEN \u00a8"}, {"time": "06:22", "desc": "CEN U 36 CEN  *Standby at up-end cab, wait for TWL crew,*CEN start service"}]}, "3\u8eca": {"id": "3\u8eca", "book_on": "01:22", "book_off": "06:32", "events": [{"time": "01:22", "desc": ""}, {"time": "00:30", "desc": "CEN 03   **72 TSWD   **T72 TWL Dn-line Last Passenger train, Please follow the TIC at all station and obey Last Passenger Train Handsignaltand 00:59 CEN \u00a8"}, {"time": "00:30", "desc": ""}, {"time": "01:22", "desc": "\u5c3e\u8eca"}, {"time": "00:21", "desc": "ETC D62 TSWU Double-end \u6536\u5ee0 00:36:00 TWD \u00a8"}, {"time": "01:23", "desc": "ETC D33 TSWU Double-end \u6536\u5ee0 01:38 TWD \u00a8"}, {"time": "03:45", "desc": "** Confirm TCI \u662f\u5426\u9700\u8981prepare T36 **"}, {"time": "05:25", "desc": "ETC *50 TWD PREPARATION + \u51fa\u5ee0 05:39 TSWD \u00a8"}, {"time": "05:30", "desc": "ETC **36 TWD PREPARATION"}, {"time": "05:35", "desc": "ETC 53 TWD PREPARATION"}, {"time": "05:45", "desc": "ETC 54 TWD PREPARATION  "}, {"time": "06:13", "desc": "ETC 27 TWD PREPARATION"}, {"time": "06:41", "desc": "ETC 35 TWD PREPARATION"}, {"time": "06:27", "desc": "ETC T80 TWD confirm TCI for T80 train preparation before book off"}, {"time": "06:17", "desc": "ETC D47 TWD \u5fc5\u9808\u7531\u8eca\u982d\u4e0a\u8eca\u8207\u8eca\u9577\u806f\u7d61\u505aDouble-end 06:32:00 TSWD \u00a8"}]}, "31001": {"id": "31001", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "31002": {"id": "31002", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "31003": {"id": "31003", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "31004": {"id": "31004", "book_on": "05:15", "book_off": "06:28", "events": [{"time": "05:15", "desc": "Start"}, {"time": "06:13", "desc": "D27 TWD \u5fc5\u9808\u7531\u8eca\u982d\u4e0a\u8eca\u8207\u8eca\u9577\u806f\u7d61\u505aDouble-end 06:28 TSWD \u00a8"}]}, "31005": {"id": "31005", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "31006": {"id": "31006", "book_on": "05:20", "book_off": "05:20", "events": [{"time": "05:20", "desc": "Start"}]}, "31007": {"id": "31007", "book_on": "05:24", "book_off": "07:21", "events": [{"time": "05:24", "desc": "Start"}, {"time": "06:12", "desc": "    42 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 06:46) 07:21 TSWD \u00a8 \u00a8"}]}, "31008": {"id": "31008", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "31009": {"id": "31009", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "31010": {"id": "31010", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "31011": {"id": "31011", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "31012": {"id": "31012", "book_on": "05:36", "book_off": "05:36", "events": [{"time": "05:36", "desc": "Start"}]}, "31013": {"id": "31013", "book_on": "05:38", "book_off": "05:38", "events": [{"time": "05:38", "desc": "Start"}]}, "31014": {"id": "31014", "book_on": "05:48", "book_off": "07:44", "events": [{"time": "05:48", "desc": "Start"}, {"time": "06:36", "desc": "48 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:10) 07:44 TSWD \u00a8 \u00a8"}]}, "31015": {"id": "31015", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "31016": {"id": "31016", "book_on": "05:52", "book_off": "05:52", "events": [{"time": "05:52", "desc": "Start"}]}, "31017": {"id": "31017", "book_on": "05:57", "book_off": "05:57", "events": [{"time": "05:57", "desc": "Start"}]}, "31018": {"id": "31018", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "31019": {"id": "31019", "book_on": "06:04", "book_off": "06:04", "events": [{"time": "06:04", "desc": "Start"}]}, "31020": {"id": "31020", "book_on": "06:14", "book_off": "06:21", "events": [{"time": "06:14", "desc": "Start"}, {"time": "06:28", "desc": "*T80 TWD \u51fa\u5ee0 and Run empty to ADM SDG as spare train 07:15 ADS \u00a8"}, {"time": "07:34", "desc": ""}, {"time": "06:21", "desc": ""}]}, "31021": {"id": "31021", "book_on": "06:18", "book_off": "07:38", "events": [{"time": "06:18", "desc": "Start"}, {"time": "07:06", "desc": "38 TSWD   07:38 CEN \u00a8"}]}, "31022": {"id": "31022", "book_on": "06:27", "book_off": "07:47", "events": [{"time": "06:27", "desc": "Start"}, {"time": "07:14", "desc": "55 TSWD 07:47 CEN \u00a8"}]}, "31023": {"id": "31023", "book_on": "06:31", "book_off": "07:51", "events": [{"time": "06:31", "desc": "Start"}, {"time": "07:19", "desc": "56 TSWD 07:51 CEN \u00a8"}]}, "31024": {"id": "31024", "book_on": "06:35", "book_off": "07:55", "events": [{"time": "06:35", "desc": "Start"}, {"time": "07:23", "desc": "43 TSWD 07:55 CEN \u00a8"}]}, "31025": {"id": "31025", "book_on": "06:38", "book_off": "06:38", "events": [{"time": "06:38", "desc": "Start"}]}, "31026": {"id": "31026", "book_on": "06:42", "book_off": "08:02", "events": [{"time": "06:42", "desc": "Start"}, {"time": "07:29", "desc": "45 TSWD 08:02 CEN \u00a8"}]}, "31027": {"id": "31027", "book_on": "06:45", "book_off": "08:01", "events": [{"time": "06:45", "desc": "Start"}, {"time": "07:47", "desc": "51 TWD Train Preparation + \u51fa\u5ee0 08:01 TSWD \u00a8"}]}, "31028": {"id": "31028", "book_on": "06:46", "book_off": "08:06", "events": [{"time": "06:46", "desc": "Start"}, {"time": "07:34", "desc": "58 TSWD 08:06 CEN \u00a8"}]}, "31029": {"id": "31029", "book_on": "06:50", "book_off": "08:10", "events": [{"time": "06:50", "desc": "Start"}, {"time": "07:38", "desc": "28 TSWD 08:10 CEN \u00a8"}]}, "31030": {"id": "31030", "book_on": "06:55", "book_off": "08:15", "events": [{"time": "06:55", "desc": "Start"}, {"time": "07:42", "desc": "29 TSWD 08:15 CEN \u00a8"}]}, "31031": {"id": "31031", "book_on": "06:59", "book_off": "08:19", "events": [{"time": "06:59", "desc": "Start"}, {"time": "07:46", "desc": "30 TSWD 08:19 CEN \u00a8"}]}, "31032": {"id": "31032", "book_on": "07:03", "book_off": "08:23", "events": [{"time": "07:03", "desc": "Start"}, {"time": "07:51", "desc": "49 TSWD   08:23 CEN \u00a8"}]}, "31033": {"id": "31033", "book_on": "07:10", "book_off": "08:30", "events": [{"time": "07:10", "desc": "Start"}, {"time": "07:57", "desc": "33 TSWD   08:30 CEN \u00a8"}]}, "A1": {"id": "A1", "book_on": "07:17", "book_off": "07:17", "events": [{"time": "07:17", "desc": "Start"}]}, "31034": {"id": "31034", "book_on": "07:18", "book_off": "08:38", "events": [{"time": "07:18", "desc": "Start"}, {"time": "08:06", "desc": "52 TSWD   08:38 CEN \u00a8"}]}, "31035": {"id": "31035", "book_on": "07:45", "book_off": "09:10", "events": [{"time": "07:45", "desc": "Start"}, {"time": "08:36", "desc": "51 CEN  SB  09:10 TSWD \u00a8"}]}, "31036": {"id": "31036", "book_on": "08:04", "book_off": "09:25", "events": [{"time": "08:04", "desc": "Start"}, {"time": "08:51", "desc": "54 CEN  SB  09:25 TSWD \u00a8"}]}, "31037": {"id": "31037", "book_on": "08:08", "book_off": "08:08", "events": [{"time": "08:08", "desc": "Start"}]}, "31038": {"id": "31038", "book_on": "08:13", "book_off": "08:13", "events": [{"time": "08:13", "desc": "Start"}]}, "31039": {"id": "31039", "book_on": "08:17", "book_off": "09:37", "events": [{"time": "08:17", "desc": "Start"}, {"time": "09:04", "desc": "42 CEN  SB  09:37 TSWD \u00a8"}]}, "31040": {"id": "31040", "book_on": "08:28", "book_off": "08:28", "events": [{"time": "08:28", "desc": "Start"}]}, "31041": {"id": "31041", "book_on": "08:32", "book_off": "08:32", "events": [{"time": "08:32", "desc": "Start"}]}, "31042": {"id": "31042", "book_on": "08:45", "book_off": "08:45", "events": [{"time": "08:45", "desc": "Start"}]}, "31043": {"id": "31043", "book_on": "09:02", "book_off": "09:02", "events": [{"time": "09:02", "desc": "Start"}]}, "31044": {"id": "31044", "book_on": "09:15", "book_off": "09:15", "events": [{"time": "09:15", "desc": "Start"}]}, "31045": {"id": "31045", "book_on": "12:30", "book_off": "15:23", "events": [{"time": "12:30", "desc": "Start"}, {"time": "14:12", "desc": "40 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 14:49) 15:23:00 TSWD \u00a8 \u00a8"}]}, "31046": {"id": "31046", "book_on": "12:41", "book_off": "15:27", "events": [{"time": "12:41", "desc": "Start"}, {"time": "14:16", "desc": "41 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 14:52) 15:27:00 TSWD \u00a8 \u00a8"}]}, "31047": {"id": "31047", "book_on": "13:20", "book_off": "15:59", "events": [{"time": "13:20", "desc": "Start"}, {"time": "14:48", "desc": "30 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 15:24) 15:59:00 TSWD \u00a8 \u00a8"}]}, "31048": {"id": "31048", "book_on": "13:27", "book_off": "16:07", "events": [{"time": "13:27", "desc": "Start"}, {"time": "14:55", "desc": "32 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 15:31) 16:07:00 TSWD \u00a8 \u00a8"}]}, "31049": {"id": "31049", "book_on": "13:34", "book_off": "16:14", "events": [{"time": "13:34", "desc": "Start"}, {"time": "15:02", "desc": "34 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 15:38) 16:14:00 TSWD \u00a8 \u00a8"}]}, "31050": {"id": "31050", "book_on": "14:23", "book_off": "17:03", "events": [{"time": "14:23", "desc": "Start"}, {"time": "15:52", "desc": "28 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 16:28) 17:03:00 TSWD \u00a8 \u00a8"}]}, "31051": {"id": "31051", "book_on": "14:41", "book_off": "16:41", "events": [{"time": "14:41", "desc": "Start"}, {"time": "16:09", "desc": "33 TSWD 16:41:00 CEN \u00a8"}]}, "31052": {"id": "31052", "book_on": "14:55", "book_off": "16:53", "events": [{"time": "14:55", "desc": "Start"}, {"time": "16:22", "desc": "63 TSWD 16:53:00 CEN \u00a8"}]}, "31053": {"id": "31053", "book_on": "15:03", "book_off": "17:00", "events": [{"time": "15:03", "desc": "Start"}, {"time": "16:29", "desc": "38 TSWD 17:00:00 CEN \u00a8"}]}, "31054": {"id": "31054", "book_on": "15:10", "book_off": "17:06", "events": [{"time": "15:10", "desc": "Start"}, {"time": "16:35", "desc": "40 TSWD 17:06:00 CEN \u00a8"}]}, "31055": {"id": "31055", "book_on": "15:13", "book_off": "15:13", "events": [{"time": "15:13", "desc": "Start"}]}, "31056": {"id": "31056", "book_on": "15:24", "book_off": "15:24", "events": [{"time": "15:24", "desc": "Start"}]}, "31057": {"id": "31057", "book_on": "15:27", "book_off": "17:25", "events": [{"time": "15:27", "desc": "Start"}, {"time": "16:54", "desc": "69 TSWD 17:25:00 CEN \u00a8"}]}, "31058": {"id": "31058", "book_on": "15:28", "book_off": "16:47", "events": [{"time": "15:28", "desc": "Start"}, {"time": "16:16", "desc": "62 TSWD 16:47:00 CEN \u00a8"}]}, "31059": {"id": "31059", "book_on": "15:31", "book_off": "17:27", "events": [{"time": "15:31", "desc": "Start"}, {"time": "16:56", "desc": "46 TSWD   17:27:00 CEN \u00a8"}]}, "31060": {"id": "31060", "book_on": "15:35", "book_off": "16:48", "events": [{"time": "15:35", "desc": "Start"}, {"time": "16:33", "desc": "68 TWD Train Preparation + \u51fa\u5ee0 16:48:00 TSWD \u00a8"}]}, "31061": {"id": "31061", "book_on": "15:39", "book_off": "17:13", "events": [{"time": "15:39", "desc": "Start"}, {"time": "16:41", "desc": "42 TSWD   17:13:00 CEN \u00a8"}]}, "31062": {"id": "31062", "book_on": "15:42", "book_off": "17:05", "events": [{"time": "15:42", "desc": "Start"}, {"time": "16:30", "desc": "29 CEN 1st SB at CEN(TWL)  17:05:00 TSWD \u00a8"}]}, "31063": {"id": "31063", "book_on": "15:45", "book_off": "17:07", "events": [{"time": "15:45", "desc": "Start"}, {"time": "16:32", "desc": "30 CEN  SB       17:07:00 TSWD \u00a8"}]}, "31064": {"id": "31064", "book_on": "15:45", "book_off": "17:04", "events": [{"time": "15:45", "desc": "Start"}, {"time": "16:33", "desc": "65 TSWD 17:04:00 CEN \u00a8"}]}, "31065": {"id": "31065", "book_on": "15:49", "book_off": "17:09", "events": [{"time": "15:49", "desc": "Start"}, {"time": "16:34", "desc": "59 CEN  SB       17:09:00 TSWD \u00a8"}]}, "31066": {"id": "31066", "book_on": "15:49", "book_off": "17:08", "events": [{"time": "15:49", "desc": "Start"}, {"time": "16:37", "desc": "66 TSWD 17:08:00 CEN \u00a8"}]}, "31067": {"id": "31067", "book_on": "15:51", "book_off": "16:22", "events": [{"time": "15:51", "desc": "Start"}, {"time": "16:08", "desc": "63 TWD \u51fa\u5ee0 16:22:00 TSWD \u00a8"}]}, "31068": {"id": "31068", "book_on": "15:55", "book_off": "17:15", "events": [{"time": "15:55", "desc": "Start"}, {"time": "16:41", "desc": "32 CEN  SB  17:15:00 TSWD \u00a8"}]}, "31069": {"id": "31069", "book_on": "16:10", "book_off": "16:10", "events": [{"time": "16:10", "desc": "Start"}]}, "31070": {"id": "31070", "book_on": "16:21", "book_off": "17:41", "events": [{"time": "16:21", "desc": "Start"}, {"time": "17:06", "desc": "65 CEN  SB          17:41:00 TSWD \u00a8"}]}, "31071": {"id": "31071", "book_on": "16:29", "book_off": "17:50", "events": [{"time": "16:29", "desc": "Start"}, {"time": "17:15", "desc": "42 CEN  SB       17:50:00 TSWD \u00a8"}]}, "31072": {"id": "31072", "book_on": "16:33", "book_off": "17:54", "events": [{"time": "16:33", "desc": "Start"}, {"time": "17:19", "desc": "43 CEN  SB       17:54:00 TSWD \u00a8"}]}, "31073": {"id": "31073", "book_on": "16:36", "book_off": "17:56", "events": [{"time": "16:36", "desc": "Start"}, {"time": "17:21", "desc": "68 CEN  SB       17:56:00 TSWD \u00a8"}]}, "31074": {"id": "31074", "book_on": "16:38", "book_off": "17:58", "events": [{"time": "16:38", "desc": "Start"}, {"time": "17:23", "desc": "44 CEN  SB       17:58:00 TSWD \u00a8"}]}, "31075": {"id": "31075", "book_on": "16:40", "book_off": "18:00", "events": [{"time": "16:40", "desc": "Start"}, {"time": "17:25", "desc": "45 CEN  SB       18:00 TSWD \u00a8  "}]}, "31076": {"id": "31076", "book_on": "16:48", "book_off": "18:09", "events": [{"time": "16:48", "desc": "Start"}, {"time": "17:34", "desc": "27 CEN  SB       18:09:00 TSWD \u00a8  "}]}, "31077": {"id": "31077", "book_on": "16:51", "book_off": "18:11", "events": [{"time": "16:51", "desc": "Start"}, {"time": "17:36", "desc": "28 CEN  SB       18:11:00 TSWD \u00a8"}]}, "31078": {"id": "31078", "book_on": "16:53", "book_off": "18:13", "events": [{"time": "16:53", "desc": "Start"}, {"time": "17:38", "desc": "29 CEN  SB       18:13:00 TSWD \u00a8"}]}, "31079": {"id": "31079", "book_on": "16:55", "book_off": "18:15", "events": [{"time": "16:55", "desc": "Start"}, {"time": "17:40", "desc": "30 CEN  SB       18:15:00 TSWD \u00a8"}]}, "31080": {"id": "31080", "book_on": "17:05", "book_off": "18:26", "events": [{"time": "17:05", "desc": "Start"}, {"time": "17:51", "desc": "33 CEN  SB       18:26:00 TSWD \u00a8"}]}, "2": {"id": "2", "book_on": "00:46", "book_off": "00:47", "events": [{"time": "00:46", "desc": ""}, {"time": "00:47", "desc": ""}, {"time": "00:46", "desc": "Train No. MOK Up PRE Up 00:47:50"}]}, "3": {"id": "3", "book_on": "00:35", "book_off": "01:22", "events": [{"time": "00:35", "desc": "SA 27 CEN MOK Up 00:46:15"}, {"time": "00:37", "desc": "ADM Up PRE Up 00:47:50"}, {"time": "00:41", "desc": "TST Up MEF Up 00:55:00"}, {"time": "00:24", "desc": "A \u4e0b\u4e00\u7ad9\u91d1\u9418,  Next station Admiralty"}, {"time": "00:35", "desc": "B \u4e0b\u4e00\u7ad9\u91d1\u9418,  Next station Admiralty"}, {"time": "00:37", "desc": "C \u4e0b\u4e00\u7ad9\u5c16\u6c99\u5480,  Next station Tsim Sha Tsui"}, {"time": "00:53", "desc": "D \u4e0b\u4e00\u7ad9\u7f8e\u5b5a,      Next station Mei Foo"}, {"time": "01:22", "desc": ""}]}, "31081": {"id": "31081", "book_on": "17:08", "book_off": "18:28", "events": [{"time": "17:08", "desc": "Start"}, {"time": "17:53", "desc": "61 CEN  SB       18:28:00 TSWD \u00a8"}]}, "31082": {"id": "31082", "book_on": "17:10", "book_off": "18:30", "events": [{"time": "17:10", "desc": "Start"}, {"time": "17:55", "desc": "34 CEN  SB       18:30 TSWD \u00a8"}]}, "31083": {"id": "31083", "book_on": "17:12", "book_off": "18:32", "events": [{"time": "17:12", "desc": "Start"}, {"time": "17:57", "desc": "62 CEN  SB       18:32 TSWD \u00a8"}]}, "31084": {"id": "31084", "book_on": "17:14", "book_off": "18:34", "events": [{"time": "17:14", "desc": "Start"}, {"time": "18:00", "desc": "35 CEN  SB  18:34 TSWD \u00a8"}]}, "31085": {"id": "31085", "book_on": "17:20", "book_off": "18:41", "events": [{"time": "17:20", "desc": "Start"}, {"time": "18:06", "desc": "37 CEN  SB       18:41:00 TSWD \u00a8"}]}, "31086": {"id": "31086", "book_on": "17:25", "book_off": "18:45", "events": [{"time": "17:25", "desc": "Start"}, {"time": "18:10", "desc": "38 CEN  SB       18:45:00 TSWD \u00a8"}]}, "31087": {"id": "31087", "book_on": "17:31", "book_off": "18:51", "events": [{"time": "17:31", "desc": "Start"}, {"time": "18:17", "desc": "40 CEN  SB       18:51:00 TSWD \u00a8"}]}, "31088": {"id": "31088", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "31089": {"id": "31089", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "31090": {"id": "31090", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "31091": {"id": "31091", "book_on": "13:30", "book_off": "13:30", "events": [{"time": "13:30", "desc": "Start"}]}, "31092": {"id": "31092", "book_on": "17:50", "book_off": "06:32", "events": [{"time": "17:50", "desc": "Start"}, {"time": "00:24", "desc": "ETC D37 TSWU Double-end \u6536\u5ee0 00:39 TWD \u00a8"}, {"time": "01:23", "desc": "ETC D34 TSWU Double-end \u6536\u5ee0 01:38 TWD \u00a8"}, {"time": "03:45", "desc": "** Confirm TCI prepare T36 or T35 **"}, {"time": "05:25", "desc": "ETC *50 TWD PREPARATION + \u51fa\u5ee0 05:39 TSWD \u00a8"}, {"time": "05:30", "desc": "ETC **36 TWD PREPARATION"}, {"time": "05:35", "desc": "ETC 53 TWD PREPARATION"}, {"time": "05:45", "desc": "ETC 54 TWD PREPARATION  "}, {"time": "06:13", "desc": "ETC 27 TWD PREPARATION"}, {"time": "06:41", "desc": "ETC **35 TWD PREPARATION"}, {"time": "06:28", "desc": "ETC T80 TWD confirm TCI for T80 train preparation before book off"}, {"time": "06:17", "desc": "ETC D47 TWD \u5fc5\u9808\u7531\u8eca\u982d\u4e0a\u8eca\u8207\u8eca\u9577\u806f\u7d61\u505aDouble-end 06:32 TSWD \u00a8"}]}, "36001": {"id": "36001", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "36002": {"id": "36002", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "36003": {"id": "36003", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "36004": {"id": "36004", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "36005": {"id": "36005", "book_on": "05:17", "book_off": "05:17", "events": [{"time": "05:17", "desc": "Start"}]}, "36006": {"id": "36006", "book_on": "05:24", "book_off": "05:24", "events": [{"time": "05:24", "desc": "Start"}]}, "36007": {"id": "36007", "book_on": "05:27", "book_off": "05:27", "events": [{"time": "05:27", "desc": "Start"}]}, "36008": {"id": "36008", "book_on": "05:28", "book_off": "05:28", "events": [{"time": "05:28", "desc": "Start"}]}, "36009": {"id": "36009", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "36010": {"id": "36010", "book_on": "05:42", "book_off": "05:42", "events": [{"time": "05:42", "desc": "Start"}]}, "36011": {"id": "36011", "book_on": "05:46", "book_off": "05:46", "events": [{"time": "05:46", "desc": "Start"}]}, "36012": {"id": "36012", "book_on": "05:48", "book_off": "05:48", "events": [{"time": "05:48", "desc": "Start"}]}, "36013": {"id": "36013", "book_on": "05:53", "book_off": "05:53", "events": [{"time": "05:53", "desc": "Start"}]}, "36014": {"id": "36014", "book_on": "05:55", "book_off": "05:55", "events": [{"time": "05:55", "desc": "Start"}]}, "36015": {"id": "36015", "book_on": "05:58", "book_off": "05:58", "events": [{"time": "05:58", "desc": "Start"}]}, "36016": {"id": "36016", "book_on": "06:05", "book_off": "06:05", "events": [{"time": "06:05", "desc": "Start"}]}, "36017": {"id": "36017", "book_on": "06:08", "book_off": "06:08", "events": [{"time": "06:08", "desc": "Start"}]}, "36018": {"id": "36018", "book_on": "06:18", "book_off": "06:18", "events": [{"time": "06:18", "desc": "Start"}]}, "36019": {"id": "36019", "book_on": "06:28", "book_off": "06:28", "events": [{"time": "06:28", "desc": "Start"}]}, "36020": {"id": "36020", "book_on": "06:32", "book_off": "06:32", "events": [{"time": "06:32", "desc": "Start"}]}, "36021": {"id": "36021", "book_on": "06:45", "book_off": "06:45", "events": [{"time": "06:45", "desc": "Start"}]}, "36022": {"id": "36022", "book_on": "06:55", "book_off": "06:55", "events": [{"time": "06:55", "desc": "Start"}]}, "36023": {"id": "36023", "book_on": "07:00", "book_off": "07:00", "events": [{"time": "07:00", "desc": "Start"}]}, "36024": {"id": "36024", "book_on": "07:07", "book_off": "07:07", "events": [{"time": "07:07", "desc": "Start"}]}, "36025": {"id": "36025", "book_on": "07:17", "book_off": "07:17", "events": [{"time": "07:17", "desc": "Start"}]}, "36026": {"id": "36026", "book_on": "07:19", "book_off": "07:19", "events": [{"time": "07:19", "desc": "Start"}]}, "36027": {"id": "36027", "book_on": "07:25", "book_off": "07:25", "events": [{"time": "07:25", "desc": "Start"}]}, "36028": {"id": "36028", "book_on": "07:29", "book_off": "07:29", "events": [{"time": "07:29", "desc": "Start"}]}, "36029": {"id": "36029", "book_on": "07:50", "book_off": "07:50", "events": [{"time": "07:50", "desc": "Start"}]}, "36030": {"id": "36030", "book_on": "07:54", "book_off": "07:54", "events": [{"time": "07:54", "desc": "Start"}]}, "36031": {"id": "36031", "book_on": "08:16", "book_off": "08:16", "events": [{"time": "08:16", "desc": "Start"}]}, "36032": {"id": "36032", "book_on": "08:28", "book_off": "08:28", "events": [{"time": "08:28", "desc": "Start"}]}, "36033": {"id": "36033", "book_on": "08:30", "book_off": "08:30", "events": [{"time": "08:30", "desc": "Start"}]}, "36034": {"id": "36034", "book_on": "08:45", "book_off": "08:45", "events": [{"time": "08:45", "desc": "Start"}]}, "36035": {"id": "36035", "book_on": "08:50", "book_off": "08:50", "events": [{"time": "08:50", "desc": "Start"}]}, "36036": {"id": "36036", "book_on": "08:50", "book_off": "08:50", "events": [{"time": "08:50", "desc": "Start"}]}, "36037": {"id": "36037", "book_on": "09:17", "book_off": "09:17", "events": [{"time": "09:17", "desc": "Start"}]}, "36038": {"id": "36038", "book_on": "09:33", "book_off": "09:33", "events": [{"time": "09:33", "desc": "Start"}]}, "36039": {"id": "36039", "book_on": "09:40", "book_off": "09:40", "events": [{"time": "09:40", "desc": "Start"}]}, "36040": {"id": "36040", "book_on": "09:40", "book_off": "09:40", "events": [{"time": "09:40", "desc": "Start"}]}, "S1": {"id": "S1", "book_on": "10:15", "book_off": "10:15", "events": [{"time": "10:15", "desc": "Start"}]}, "36041": {"id": "36041", "book_on": "10:16", "book_off": "10:16", "events": [{"time": "10:16", "desc": "Start"}]}, "36042": {"id": "36042", "book_on": "10:37", "book_off": "10:37", "events": [{"time": "10:37", "desc": "Start"}]}, "36043": {"id": "36043", "book_on": "11:10", "book_off": "11:10", "events": [{"time": "11:10", "desc": "Start"}]}, "36044": {"id": "36044", "book_on": "11:30", "book_off": "03:45", "events": [{"time": "11:30", "desc": "Start"}, {"time": "03:36", "desc": "Total 358.5"}, {"time": "03:45", "desc": "Total 322.5 Aver. 7.966666666666667 7.466666666666667 Total DL 22"}]}, "36090": {"id": "36090", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "36091": {"id": "36091", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "36092": {"id": "36092", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "37001": {"id": "37001", "book_on": "05:15", "book_off": "06:10", "events": [{"time": "05:15", "desc": "Start"}, {"time": "05:32", "desc": "*23 TWD Prep by ETC(Not in Service) 06:10 CEN \u00a8"}]}, "2026\u5e74": {"id": "2026\u5e74", "book_on": "05:42", "book_off": "12:15", "events": [{"time": "05:42", "desc": "*R22 TSWD (05:39\u4e58\u5750T22 up cab\u843d\u4e2d\u74b0\u63a5T23) 06:10 CEN \u00a8"}, {"time": "06:21", "desc": "23 CEN* * CEN  Start   Service 06:56 TSWD \u00a8"}, {"time": "06:44", "desc": "6.5 / 7"}, {"time": "07:01", "desc": "24 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:36) 08:10:00 TSWD \u00a8 \u00a8"}, {"time": "08:15", "desc": "Report to TCO / TCI for briefing/duty 09:30:00"}, {"time": "10:15", "desc": "10:36:00 Report to TCO / TCI for briefing/duty 10:54:00"}, {"time": "10:57", "desc": "34 TSWD 11:27:00 CEN \u00a8"}, {"time": "11:34", "desc": "35 CEN SB 12:08:00 TSWD \u00a8 12:15:00"}, {"time": "01:22", "desc": ""}]}, "37002": {"id": "37002", "book_on": "05:15", "book_off": "06:38", "events": [{"time": "05:15", "desc": "Start"}, {"time": "06:22", "desc": "39 TWD Preperation+\u51fa\u5ee0 06:38 TSWD \u00a8"}]}, "37003": {"id": "37003", "book_on": "05:15", "book_off": "06:38", "events": [{"time": "05:15", "desc": "Start"}, {"time": "06:22", "desc": "*D39 TWD Double-end \u51fa\u5ee0 06:38 TSWD \u00a8"}]}, "37004": {"id": "37004", "book_on": "05:18", "book_off": "07:16", "events": [{"time": "05:18", "desc": "Start"}, {"time": "06:06", "desc": "30 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 06:40) 07:16 TSWD \u00a8 \u00a8"}]}, "37005": {"id": "37005", "book_on": "05:20", "book_off": "05:20", "events": [{"time": "05:20", "desc": "Start"}]}, "37006": {"id": "37006", "book_on": "05:24", "book_off": "07:21", "events": [{"time": "05:24", "desc": "Start"}, {"time": "06:12", "desc": "31 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 06:47) 07:21 TSWD \u00a8 \u00a8"}]}, "37007": {"id": "37007", "book_on": "05:27", "book_off": "05:27", "events": [{"time": "05:27", "desc": "Start"}]}, "37008": {"id": "37008", "book_on": "05:32", "book_off": "05:32", "events": [{"time": "05:32", "desc": "Start"}]}, "37009": {"id": "37009", "book_on": "05:35", "book_off": "05:35", "events": [{"time": "05:35", "desc": "Start"}]}, "37010": {"id": "37010", "book_on": "05:40", "book_off": "05:40", "events": [{"time": "05:40", "desc": "Start"}]}, "37011": {"id": "37011", "book_on": "05:40", "book_off": "07:26", "events": [{"time": "05:40", "desc": "Start"}, {"time": "06:18", "desc": "33 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 06:52) 07:26 TSWD \u00a8 \u00a8"}]}, "37012": {"id": "37012", "book_on": "05:45", "book_off": "07:46", "events": [{"time": "05:45", "desc": "Start"}, {"time": "06:38", "desc": "39 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:12) 07:46 TSWD \u00a8 \u00a8"}]}, "37013": {"id": "37013", "book_on": "05:56", "book_off": "07:41", "events": [{"time": "05:56", "desc": "Start"}, {"time": "06:33", "desc": "38 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:08) 07:41 TSWD \u00a8 \u00a8"}]}, "37014": {"id": "37014", "book_on": "05:58", "book_off": "07:56", "events": [{"time": "05:58", "desc": "Start"}, {"time": "06:46", "desc": "42 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:21) 07:56 TSWD \u00a8 \u00a8"}]}, "37015": {"id": "37015", "book_on": "06:18", "book_off": "08:18", "events": [{"time": "06:18", "desc": "Start"}, {"time": "07:06", "desc": "27 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 07:41) 08:18 TSWD \u00a8 \u00a8"}]}, "37016": {"id": "37016", "book_on": "06:41", "book_off": "09:18", "events": [{"time": "06:41", "desc": "Start"}, {"time": "08:10", "desc": "24 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 08:45) 09:18 TSWD \u00a8 \u00a8"}]}, "37017": {"id": "37017", "book_on": "07:31", "book_off": "09:30", "events": [{"time": "07:31", "desc": "Start"}, {"time": "09:00", "desc": "40 TSWD 09:30:00 CEN \u00a8"}]}, "37018": {"id": "37018", "book_on": "07:50", "book_off": "09:49", "events": [{"time": "07:50", "desc": "Start"}, {"time": "08:39", "desc": "34 TSWD (\u81ea\u5df1\u8abf\u982d\uff0cCEN depart 09:15) 09:49 TSWD \u00a8 \u00a8"}]}, "37019": {"id": "37019", "book_on": "08:08", "book_off": "10:16", "events": [{"time": "08:08", "desc": "Start"}, {"time": "09:46", "desc": "33 TSWD 10:16:00 CEN \u00a8"}]}, "37020": {"id": "37020", "book_on": "08:12", "book_off": "10:10", "events": [{"time": "08:12", "desc": "Start"}, {"time": "09:40", "desc": "31 TSWD 10:10:00 CEN \u00a8"}]}, "37021": {"id": "37021", "book_on": "08:14", "book_off": "09:33", "events": [{"time": "08:14", "desc": "Start"}, {"time": "09:03", "desc": "41 TSWD 09:33 CEN \u00a8"}]}, "37022": {"id": "37022", "book_on": "08:20", "book_off": "09:39", "events": [{"time": "08:20", "desc": "Start"}, {"time": "09:09", "desc": "21 TSWD 09:39 CEN \u00a8"}]}, "37023": {"id": "37023", "book_on": "08:25", "book_off": "10:32", "events": [{"time": "08:25", "desc": "Start"}, {"time": "10:01", "desc": "38 TSWD 10:32:00 CEN \u00a8"}]}, "37024": {"id": "37024", "book_on": "08:33", "book_off": "10:34", "events": [{"time": "08:33", "desc": "Start"}, {"time": "10:04", "desc": "39 TSWD 10:34:00 CEN \u00a8"}]}, "37025": {"id": "37025", "book_on": "08:33", "book_off": "09:52", "events": [{"time": "08:33", "desc": "Start"}, {"time": "09:21", "desc": "25 TSWD 09:52:00 CEN \u00a8"}]}, "37026": {"id": "37026", "book_on": "08:37", "book_off": "10:40", "events": [{"time": "08:37", "desc": "Start"}, {"time": "10:04", "desc": "Report to TCO / TCI for briefing/duty 10:40:00"}]}, "37027": {"id": "37027", "book_on": "08:41", "book_off": "10:37", "events": [{"time": "08:41", "desc": "Start"}, {"time": "10:07", "desc": "40 TSWD 10:37:00 CEN \u00a8"}]}, "37028": {"id": "37028", "book_on": "08:45", "book_off": "10:05", "events": [{"time": "08:45", "desc": "Start"}, {"time": "09:33", "desc": "29 TSWD 10:05:00 CEN \u00a8"}]}, "37029": {"id": "37029", "book_on": "08:46", "book_off": "10:44", "events": [{"time": "08:46", "desc": "Start"}, {"time": "10:14", "desc": "42 TSWD 10:44:00 CEN \u00a8"}]}, "37030": {"id": "37030", "book_on": "08:46", "book_off": "10:07", "events": [{"time": "08:46", "desc": "Start"}, {"time": "09:34", "desc": "40 CEN SB 10:07:00 TSWD \u00a8"}]}, "37031": {"id": "37031", "book_on": "08:54", "book_off": "10:13", "events": [{"time": "08:54", "desc": "Start"}, {"time": "09:43", "desc": "32 TSWD 10:13:00 CEN \u00a8"}]}, "37032": {"id": "37032", "book_on": "09:00", "book_off": "10:23", "events": [{"time": "09:00", "desc": "Start"}, {"time": "09:49", "desc": "23 CEN SB 10:23:00 TSWD \u00a8"}]}, "37033": {"id": "37033", "book_on": "09:03", "book_off": "10:26", "events": [{"time": "09:03", "desc": "Start"}, {"time": "09:55", "desc": "36 TSWD 10:26:00 CEN \u00a8"}]}, "37034": {"id": "37034", "book_on": "09:05", "book_off": "10:26", "events": [{"time": "09:05", "desc": "Start"}, {"time": "09:52", "desc": "24 CEN SB 10:26:00 TSWD \u00a8"}]}, "37035": {"id": "37035", "book_on": "09:08", "book_off": "10:29", "events": [{"time": "09:08", "desc": "Start"}, {"time": "09:55", "desc": "25 CEN SB 10:29:00 TSWD \u00a8"}]}, "37036": {"id": "37036", "book_on": "09:14", "book_off": "10:59", "events": [{"time": "09:14", "desc": "Start"}, {"time": "10:29", "desc": "25 TSWD 10:59:00 CEN \u00a8"}]}, "37037": {"id": "37037", "book_on": "09:17", "book_off": "10:38", "events": [{"time": "09:17", "desc": "Start"}, {"time": "10:05", "desc": "28 CEN SB 10:38:00 TSWD \u00a8"}]}, "37038": {"id": "37038", "book_on": "10:12", "book_off": "11:48", "events": [{"time": "10:12", "desc": "Start"}, {"time": "11:18", "desc": "41 TSWD 11:48:00 CEN \u00a8"}]}, "E1": {"id": "E1", "book_on": "11:30", "book_off": "12:41", "events": [{"time": "11:30", "desc": "Start"}, {"time": "12:11", "desc": "36 TSWD 12:41:00 CEN \u00a8"}]}, "37039": {"id": "37039", "book_on": "12:08", "book_off": "13:31", "events": [{"time": "12:08", "desc": "Start"}, {"time": "12:57", "desc": "40 CEN SB 13:31:00 TSWD \u00a8"}]}, "37040": {"id": "37040", "book_on": "12:10", "book_off": "14:16", "events": [{"time": "12:10", "desc": "Start"}, {"time": "13:46", "desc": "23 TSWD 14:16:00 CEN \u00a8"}]}, "37041": {"id": "37041", "book_on": "12:16", "book_off": "13:37", "events": [{"time": "12:16", "desc": "Start"}, {"time": "13:03", "desc": "42 CEN SB 13:37:00 TSWD \u00a8"}]}, "37042": {"id": "37042", "book_on": "12:19", "book_off": "13:40", "events": [{"time": "12:19", "desc": "Start"}, {"time": "13:07", "desc": "21 CEN SB 13:40:00 TSWD \u00a8"}]}, "37043": {"id": "37043", "book_on": "12:32", "book_off": "13:56", "events": [{"time": "12:32", "desc": "Start"}, {"time": "13:22", "desc": "26 CEN SB 13:56:00 TSWD \u00a8"}]}, "37044": {"id": "37044", "book_on": "12:38", "book_off": "13:59", "events": [{"time": "12:38", "desc": "Start"}, {"time": "13:25", "desc": "27 CEN SB 13:59:00 TSWD \u00a8"}]}, "37045": {"id": "37045", "book_on": "12:46", "book_off": "14:08", "events": [{"time": "12:46", "desc": "Start"}, {"time": "13:34", "desc": "30 CEN SB 14:08:00 TSWD \u00a8"}]}, "37046": {"id": "37046", "book_on": "12:52", "book_off": "14:14", "events": [{"time": "12:52", "desc": "Start"}, {"time": "13:40", "desc": "32 CEN SB 14:14:00 TSWD \u00a8"}]}, "37047": {"id": "37047", "book_on": "12:54", "book_off": "14:17", "events": [{"time": "12:54", "desc": "Start"}, {"time": "13:44", "desc": "33 CEN SB 14:17:00 TSWD \u00a8"}]}, "37048": {"id": "37048", "book_on": "13:03", "book_off": "14:26", "events": [{"time": "13:03", "desc": "Start"}, {"time": "13:53", "desc": "36 CEN SB 14:26:00 TSWD \u00a8"}]}, "37049": {"id": "37049", "book_on": "13:05", "book_off": "14:41", "events": [{"time": "13:05", "desc": "Start"}, {"time": "14:11", "desc": "31 TSWD 14:41:00 CEN \u00a8"}]}, "37050": {"id": "37050", "book_on": "13:15", "book_off": "14:36", "events": [{"time": "13:15", "desc": "Start"}, {"time": "14:02", "desc": "39 CEN SB 14:36:00 TSWD \u00a8"}]}, "L1": {"id": "L1", "book_on": "15:00", "book_off": "16:39", "events": [{"time": "15:00", "desc": "Start"}, {"time": "16:05", "desc": "35 CEN SB 16:39:00 TSWD \u00a8"}]}, "37051": {"id": "37051", "book_on": "15:30", "book_off": "16:51", "events": [{"time": "15:30", "desc": "Start"}, {"time": "16:18", "desc": "39 CEN SB 16:51:00 TSWD \u00a8"}]}, "37052": {"id": "37052", "book_on": "15:37", "book_off": "16:57", "events": [{"time": "15:37", "desc": "Start"}, {"time": "16:24", "desc": "41 CEN SB 16:57:00 TSWD \u00a8"}]}, "37053": {"id": "37053", "book_on": "15:49", "book_off": "17:10", "events": [{"time": "15:49", "desc": "Start"}, {"time": "16:36", "desc": "23 CEN SB 17:10:00 TSWD \u00a8"}]}, "37054": {"id": "37054", "book_on": "15:55", "book_off": "17:16", "events": [{"time": "15:55", "desc": "Start"}, {"time": "16:42", "desc": "25 CEN SB 17:16:00 TSWD \u00a8"}]}, "37055": {"id": "37055", "book_on": "15:58", "book_off": "17:19", "events": [{"time": "15:58", "desc": "Start"}, {"time": "16:45", "desc": "26 CEN SB 17:19:00 TSWD \u00a8"}]}, "37056": {"id": "37056", "book_on": "16:01", "book_off": "17:22", "events": [{"time": "16:01", "desc": "Start"}, {"time": "16:49", "desc": "27 CEN SB 17:22:00 TSWD \u00a8"}]}, "37057": {"id": "37057", "book_on": "16:10", "book_off": "19:08", "events": [{"time": "16:10", "desc": "Start"}, {"time": "16:58", "desc": "30 CEN SB 17:31:00 TSWD \u00a8"}, {"time": "17:34", "desc": "Report to TCO / TCI for briefing/duty 19:08:00"}]}, "37058": {"id": "37058", "book_on": "16:17", "book_off": "17:38", "events": [{"time": "16:17", "desc": "Start"}, {"time": "17:04", "desc": "32 CEN SB 17:38:00 TSWD \u00a8"}]}, "37059": {"id": "37059", "book_on": "16:20", "book_off": "17:41", "events": [{"time": "16:20", "desc": "Start"}, {"time": "17:07", "desc": "33 CEN SB 17:41:00 TSWD \u00a8"}]}, "37060": {"id": "37060", "book_on": "16:23", "book_off": "17:44", "events": [{"time": "16:23", "desc": "Start"}, {"time": "17:10", "desc": "34 CEN SB 17:44:00 TSWD \u00a8"}]}, "37061": {"id": "37061", "book_on": "16:26", "book_off": "17:47", "events": [{"time": "16:26", "desc": "Start"}, {"time": "17:13", "desc": "35 CEN SB 17:47:00 TSWD \u00a8"}]}, "37062": {"id": "37062", "book_on": "16:38", "book_off": "17:59", "events": [{"time": "16:38", "desc": "Start"}, {"time": "17:26", "desc": "39 CEN SB 17:59:00 TSWD \u00a8"}]}, "37063": {"id": "37063", "book_on": "16:41", "book_off": "18:02", "events": [{"time": "16:41", "desc": "Start"}, {"time": "17:29", "desc": "40 CEN SB 18:02:00 TSWD \u00a8"}]}, "37064": {"id": "37064", "book_on": "16:44", "book_off": "18:05", "events": [{"time": "16:44", "desc": "Start"}, {"time": "17:32", "desc": "41 CEN SB 18:05:00 TSWD \u00a8"}]}, "37065": {"id": "37065", "book_on": "16:51", "book_off": "18:11", "events": [{"time": "16:51", "desc": "Start"}, {"time": "17:38", "desc": "21 CEN SB 18:11:00 TSWD \u00a8"}]}, "37066": {"id": "37066", "book_on": "16:56", "book_off": "18:18", "events": [{"time": "16:56", "desc": "Start"}, {"time": "17:44", "desc": "23 CEN SB 18:18:00 TSWD \u00a8"}]}, "37067": {"id": "37067", "book_on": "16:58", "book_off": "18:21", "events": [{"time": "16:58", "desc": "Start"}, {"time": "17:47", "desc": "24 CEN SB 18:21:00 TSWD \u00a8"}]}, "37068": {"id": "37068", "book_on": "17:00", "book_off": "18:24", "events": [{"time": "17:00", "desc": "Start"}, {"time": "17:50", "desc": "25 CEN SB 18:24:00 TSWD \u00a8"}]}, "37069": {"id": "37069", "book_on": "17:03", "book_off": "18:45", "events": [{"time": "17:03", "desc": "Start"}, {"time": "18:12", "desc": "32 CEN SB 18:45:00 TSWD \u00a8"}]}, "37070": {"id": "37070", "book_on": "17:07", "book_off": "18:30", "events": [{"time": "17:07", "desc": "Start"}, {"time": "17:56", "desc": "27 CEN SB 18:30:00 TSWD \u00a8"}]}, "37071": {"id": "37071", "book_on": "17:08", "book_off": "18:26", "events": [{"time": "17:08", "desc": "Start"}, {"time": "17:56", "desc": "38 TSWD 18:26:00 CEN \u00a8"}]}, "37072": {"id": "37072", "book_on": "17:11", "book_off": "18:33", "events": [{"time": "17:11", "desc": "Start"}, {"time": "17:59", "desc": "28 CEN SB 18:33:00 TSWD \u00a8"}]}, "37073": {"id": "37073", "book_on": "17:18", "book_off": "19:01", "events": [{"time": "17:18", "desc": "Start"}, {"time": "17:50", "desc": "36 TSWD 18:20:00 CEN \u00a8"}, {"time": "18:27", "desc": "37 CEN SB 19:01:00 TSWD \u00a8"}]}, "37074": {"id": "37074", "book_on": "17:20", "book_off": "18:55", "events": [{"time": "17:20", "desc": "Start"}, {"time": "18:21", "desc": "35 CEN SB 18:55:00 TSWD \u00a8"}]}, "37075": {"id": "37075", "book_on": "17:31", "book_off": "18:52", "events": [{"time": "17:31", "desc": "Start"}, {"time": "18:18", "desc": "34 CEN SB 18:52:00 TSWD \u00a8"}]}, "37076": {"id": "37076", "book_on": "17:58", "book_off": "19:22", "events": [{"time": "17:58", "desc": "Start"}, {"time": "18:49", "desc": "22 CEN SB 19:22:00 TSWD \u00a8"}]}, "37077": {"id": "37077", "book_on": "18:41", "book_off": "20:14", "events": [{"time": "18:41", "desc": "Start"}, {"time": "19:38", "desc": "38 CEN SB 20:14:00 TSWD \u00a8"}]}, "37078": {"id": "37078", "book_on": "18:50", "book_off": "18:50", "events": [{"time": "18:50", "desc": "Start"}]}, "37079": {"id": "37079", "book_on": "18:50", "book_off": "20:39", "events": [{"time": "18:50", "desc": "Start"}, {"time": "19:25", "desc": "23 TSWD 19:56:00 CEN \u00a8"}, {"time": "20:03", "desc": "24 CEN SB 20:39:00 TSWD \u00a8"}]}, "37080": {"id": "37080", "book_on": "05:15", "book_off": "05:15", "events": [{"time": "05:15", "desc": "Start"}]}, "37081": {"id": "37081", "book_on": "06:15", "book_off": "06:15", "events": [{"time": "06:15", "desc": "Start"}]}, "37082": {"id": "37082", "book_on": "10:00", "book_off": "10:00", "events": [{"time": "10:00", "desc": "Start"}]}, "37083": {"id": "37083", "book_on": "13:30", "book_off": "13:30", "events": [{"time": "13:30", "desc": "Start"}]}, "37084": {"id": "37084", "book_on": "17:50", "book_off": "01:22", "events": [{"time": "17:50", "desc": "Start"}, {"time": "23:00", "desc": "NETC"}, {"time": "00:13", "desc": "D27 TSWU Double-end \u6536\u5ee0 00:27 TWD \u00a8"}, {"time": "01:24", "desc": "D26 TSWU Double-end \u6536\u5ee0 01:38 TWD \u00a8"}, {"time": "03:45", "desc": "** Confirm TCI \u662f\u5426\u9700\u8981 prepare T23 **"}, {"time": "05:27", "desc": "*22 TWD PREPARATION + \u51fa\u5ee0 05:42 TSWD \u00a8"}, {"time": "06:08", "desc": "**D35 TWD Double-end \u51fa\u5ee0 06:23 TSWD \u00a8"}, {"time": "05:30", "desc": "**23 TWD Preparation"}, {"time": "05:37", "desc": "24 TWD Preparation"}, {"time": "05:45", "desc": "28 TWD Preparation"}, {"time": "06:02", "desc": "33 TWD Preparation"}, {"time": "05:20", "desc": "CEN 01 *40 06:06 CEN * 1st Passenger Train (TWL/up-line) 06:42 TSWD \u00a8"}, {"time": "06:06", "desc": "**\u8343\u7063\u7dda\u4e0a\u884c\u982d\u73ed\u5ba2\u8eca, TSW Up\u4e0d\u884cAT, Auto \u51fa\u5165 T/R **"}, {"time": "01:22", "desc": ""}, {"time": "05:53", "desc": "CEN 02 23 ADS PREPARATION 05:57 ADM \u00a8"}, {"time": "06:01", "desc": "23 ADM 06:02 CEN \u00a8"}, {"time": "06:21", "desc": "23 CEN  *Standby at up-end cab, wait for TWL crew,*CEN start service"}, {"time": "01:22", "desc": ""}, {"time": "00:30", "desc": "CEN 03   **44 TSWD   **T44 TWL Dn-line Last Passenger train, Please follow the TIC at all station and obey Last Passenger Train Handsignaltand 00:59 CEN \u00a8"}, {"time": "00:30", "desc": ""}, {"time": "01:22", "desc": "\u5c3e\u8eca"}]}};
    const WEEKDAYS = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];

    const DATABASE = {};
    for (let k in RAW_DB) {
        DATABASE[String(k).trim()] = RAW_DB[k];
    }

    let state = {
        start: new Date().toISOString().split('T')[0],
        inputs: ['', '', '', '', '', '', ''],
        roster: []
    };

    window.onload = function() {
        const saved = localStorage.getItem('mtr_v22');
        if(saved) {
            try {
                const p = JSON.parse(saved);
                state.start = p.start || state.start;
                state.inputs = p.inputs || state.inputs;
            } catch(e){}
        } else {
            const d = new Date();
            const day = d.getDay();
            const diff = d.getDate() - day + (day == 0 ? -6 : 1);
            const mon = new Date(d.setDate(diff));
            state.start = mon.toISOString().split('T')[0];
        }
        document.getElementById('startDate').value = state.start;
        renderInputs();
        if(state.inputs.some(x => x)) saveAndShow();
    };

    function showStats() {
        alert("Database contains " + Object.keys(DATABASE).length + " duties.");
    }

    function renderInputs() {
        const con = document.getElementById('inputContainer');
        con.innerHTML = '';
        state.inputs.forEach((val, i) => {
            const div = document.createElement('div');
            div.className = 'duty-row';
            div.innerHTML = `<span class="day-label">${WEEKDAYS[i]}</span>`;
            const inp = document.createElement('input');
            // CHANGE: type="text" to allow letters
            inp.type = 'text'; 
            inp.className = 'duty-input';
            inp.value = val;
            inp.placeholder = '-';
            // Auto-upper case
            inp.oninput = (e) => {
                e.target.value = e.target.value.toUpperCase();
                state.inputs[i] = e.target.value;
                localStorage.setItem('mtr_v22', JSON.stringify(state));
            };
            div.appendChild(inp);
            con.appendChild(div);
        });
    }

    function updateDate(val) {
        state.start = val;
        localStorage.setItem('mtr_v22', JSON.stringify(state));
    }

    function toggleView() {
        document.getElementById('editView').style.display = 'block';
        document.getElementById('listView').style.display = 'none';
        document.getElementById('fab').classList.add('hidden');
        document.getElementById('manualLink').style.display = 'none';
        window.scrollTo(0,0);
    }

    function saveAndShow() {
        document.getElementById('editView').style.display = 'none';
        document.getElementById('listView').style.display = 'flex';
        generate();
        renderList();
        window.scrollTo(0,0);
        if(state.roster.some(x => !x.isRest)) {
            document.getElementById('fab').classList.remove('hidden');
        } else {
            document.getElementById('fab').classList.add('hidden');
        }
    }

    function generate() {
        const start = new Date(state.start);
        state.roster = state.inputs.map((v, i) => {
            const cur = new Date(start);
            cur.setDate(start.getDate() + i);
            const dateStr = cur.toISOString().split('T')[0];
            const dateLabel = `${cur.getDate()}/${cur.getMonth()+1}`;

            let id = v ? String(v).trim() : '';
            const isRest = !id || ['RD','OFF','0','AL','SH','-'].includes(id.toUpperCase());

            let item = { i, day: WEEKDAYS[i], date: dateStr, dateLabel, id, isRest, on:'', off:'', dur:'?', ev:[], manual:false };

            if(!isRest) {
                let d = DATABASE[id];
                if (!d && id.length >= 2) d = DATABASE[id.slice(-3)] || DATABASE[id.slice(-2)];

                if(d) {
                    item.on = d.book_on;
                    item.off = d.book_off;
                    item.ev = d.events;

                    // FIX: End Time Correction
                    if(item.ev.length > 1) {
                         let candidates = [];
                         // Check last 2 events desc for hidden times
                         for(let k=Math.max(0, item.ev.length-2); k<item.ev.length; k++) {
                             let e = item.ev[k];
                             let m = e.desc.match(/([0-1]?[0-9]|2[0-3]):[0-5][0-9]/g);
                             if(m) {
                                 m.forEach(t => {
                                     // Basic clean
                                     if(t.length==4) t="0"+t;
                                     if(t!=e.time && t!=item.on) candidates.push(t);
                                 });
                             }
                         }
                         if(candidates.length > 0) {
                             item.off = candidates[candidates.length-1];
                         }
                    }
                } else {
                    item.manual = true;
                }
                item.dur = calcDur(item.on, item.off);
            }
            return item;
        });
    }

    function calcDur(on, off) {
        if(!on || !off || on==off) return '?';
        try {
            const [h1,m1] = on.split(':').map(Number);
            const [h2,m2] = off.split(':').map(Number);
            let m = (h2*60+m2) - (h1*60+m1);
            if(m < 0) m += 1440;
            return (m/60).toFixed(1);
        } catch(e) { return '?'; }
    }

    function renderList() {
        const list = document.getElementById('listView');
        list.innerHTML = '';
        if(state.roster.every(x => !x.id)) {
            list.innerHTML = '<div style="text-align:center;padding:50px;color:#8e8e93;">No shifts</div>';
            return;
        }
        state.roster.forEach((item, idx) => {
            const card = document.createElement('div');
            card.className = 'card';
            let html = `<div class="card-header">
                <div class="left-col">
                    <h3>${item.day}</h3>
                    <span class="date-badge">${item.dateLabel}</span>
                    ${item.isRest ? '<span class="rest-text"> RD</span>' : `<span class="duty-id">${item.id}</span>`}
                </div>`;
            if(!item.isRest) {
                const timeStr = (item.on && item.off) ? `${item.on} - ${item.off}` : 'Set Time';
                html += `<div class="right-col">
                    <button class="time-btn" onclick="toggleEdit(${idx})">${timeStr}</button>
                    <span class="duration-text"> ${item.dur} HRS</span>
                    <div id="edit-${idx}" class="edit-zone">
                        <input type="time" class="time-edit" value="${item.on}" onchange="updTime(${idx}, 'on', this.value)">
                        <input type="time" class="time-edit" value="${item.off}" onchange="updTime(${idx}, 'off', this.value)">
                    </div>
                </div>`;
            }
            html += `</div>`;
            if(!item.isRest && item.ev.length > 0) {
                html += `<button class="task-toggle" onclick="toggleTask(${idx})">
                    <span>${item.ev.length} TASKS</span>
                    <span></span>
                </button>
                <div id="task-${idx}" class="task-list">`;
                item.ev.forEach(e => {
                    let c = 'dot';
                    const d = e.desc.toLowerCase();
                    if(d.includes('start')||d.includes('report')) c+=' blue';
                    else if(d.includes('break')||d.includes('meal')) c+=' orange';
                    else if(d.includes('off')||d.includes('end')) c+=' red';
                    html += `<div class="task-item">
                        <div class="${c}"></div>
                        <div class="task-content">
                            <div class="task-desc">${e.desc}</div>
                            <span class="task-time">${e.time}</span>
                        </div>
                    </div>`;
                });
                html += `</div>`;
            }
            card.innerHTML = html;
            list.appendChild(card);
        });
    }

    window.toggleEdit = (i) => {
        document.getElementById(`edit-${i}`).classList.toggle('show');
    };
    window.updTime = (i, type, val) => {
        state.roster[i][type] = val;
        state.roster[i].dur = calcDur(state.roster[i].on, state.roster[i].off);
        renderList();
        setTimeout(() => document.getElementById(`edit-${i}`).classList.add('show'), 10);
    };
    window.toggleTask = (i) => {
        document.getElementById(`task-${i}`).classList.toggle('show');
    };
    window.handleFile = (inp) => { /* Same */ };

    function getICSContent() {
        let ics = "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//MTR Duty Planner//EN\n";
        state.roster.forEach(x => {
            if(x.isRest || !x.on || !x.off || x.on=='?') return;
            const ds = x.date.replace(/-/g,'');
            const t1 = x.on.replace(':','')+'00';
            const t2 = x.off.replace(':','')+'00';
            let de = ds;
            if(parseInt(t2) < parseInt(t1)) {
                const d = new Date(x.date);
                d.setDate(d.getDate()+1);
                de = d.toISOString().split('T')[0].replace(/-/g,'');
            }
            let desc = "";
            x.ev.forEach(e => desc += `[${e.time}] ${e.desc}\n`);
            ics += "BEGIN:VEVENT\n";
            ics += `DTSTART;TZID=Asia/Hong_Kong:${ds}T${t1}\n`;
            ics += `DTEND;TZID=Asia/Hong_Kong:${de}T${t2}\n`;
            ics += `SUMMARY:Duty ${x.id}\n`;
            ics += `DESCRIPTION:${desc}\n`;
            ics += "BEGIN:VALARM\nTRIGGER:-PT30M\nACTION:DISPLAY\nDESCRIPTION:Duty Reminder\nEND:VALARM\n";
            ics += "END:VEVENT\n";
        });
        ics += "END:VCALENDAR";
        return ics;
    }

    window.shareCal = () => {
        const ics = getICSContent();
        const file = new File([ics], "roster.ics", { type: "text/calendar" });
        if (navigator.canShare && navigator.share) {
            navigator.share({
                files: [file],
                title: 'Duty Roster'
            }).catch(console.error);
        } else {
            downloadCal();
        }
    };

    window.downloadCal = () => {
        const ics = getICSContent();
        const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const anchor = document.getElementById('downloadAnchor');
        anchor.href = url;
        anchor.download = "roster.ics";
        document.getElementById('manualLink').style.display = 'block';
        setTimeout(() => anchor.click(), 100);
    };

</script>
</body>
</html>
